#!/usr/bin/env python3
"""
RIVALS - Railway-Ready Server
Serves the game HTML on the PORT provided by Railway (or 7373 locally).
Deploy to Railway: just upload this single file and set start command to 'python rivals_server.py'
"""
import os
import base64
from http.server import HTTPServer, BaseHTTPRequestHandler

# Embedded game HTML (base64-encoded)
HTML_B64 = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9IlVURi04Ij4KPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPgo8dGl0bGU+UklWQUxTPC90aXRsZT4KPGxpbmsgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1QcmVzcytTdGFydCsyUCZmYW1pbHk9QmFybG93K0NvbmRlbnNlZDp3Z2h0QDUwMDs2MDA7NzAwOzgwMCZkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCI+CjxzdHlsZT4KOnJvb3R7CiAgLS15OiNGRkU2MDA7LS1wazojRkYwMDgwOy0tY3k6IzAwRjVGRjsKICAtLXJlZDojRkYzMTMxOy0tYmx1ZTojMUU5MEZGOy0tZ3JlZW46IzIyQzU1RTstLXB1cnBsZTojQTg1NUY3OwogIC0tYmc6IzA1MDUwODstLXN1cmY6IzBkMGQxODstLWJkcjojMWExYTJlOy0tdHh0OiNmMGYwZmY7LS1tdXRlZDojNWE1YTkwOwp9CiosKjo6YmVmb3JlLCo6OmFmdGVye21hcmdpbjowO3BhZGRpbmc6MDtib3gtc2l6aW5nOmJvcmRlci1ib3h9Cmh0bWwsYm9keXt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO292ZXJmbG93OmhpZGRlbjtiYWNrZ3JvdW5kOnZhcigtLWJnKTtmb250LWZhbWlseTonQmFybG93IENvbmRlbnNlZCcsc2Fucy1zZXJpZjtjb2xvcjp2YXIoLS10eHQpO2ZvbnQtd2VpZ2h0OjUwMH0KLnNjcmVlbntwb3NpdGlvbjpmaXhlZDtpbnNldDowO2Rpc3BsYXk6bm9uZTtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O292ZXJmbG93LXk6YXV0b30KLnNjcmVlbi5hY3RpdmV7ZGlzcGxheTpmbGV4fQoKLyog4pSA4pSAIE1FTlUg4pSA4pSAICovCiNzLW1lbnV7CiAgYmFja2dyb3VuZDp2YXIoLS1iZyk7cGFkZGluZzoxLjVyZW0gMXJlbSAycmVtOwogIGJhY2tncm91bmQtaW1hZ2U6bGluZWFyLWdyYWRpZW50KHJnYmEoMjU1LDIzMCwwLC4wMzUpIDFweCx0cmFuc3BhcmVudCAxcHgpLGxpbmVhci1ncmFkaWVudCg5MGRlZyxyZ2JhKDI1NSwyMzAsMCwuMDM1KSAxcHgsdHJhbnNwYXJlbnQgMXB4KTsKICBiYWNrZ3JvdW5kLXNpemU6NTVweCA1NXB4O2FuaW1hdGlvbjpncyAyMnMgbGluZWFyIGluZmluaXRlOwp9CkBrZXlmcmFtZXMgZ3N7ZnJvbXtiYWNrZ3JvdW5kLXBvc2l0aW9uOjAgMH10b3tiYWNrZ3JvdW5kLXBvc2l0aW9uOjU1cHggNTVweH19Ci5vcmJ7cG9zaXRpb246YWJzb2x1dGU7Ym9yZGVyLXJhZGl1czo1MCU7ZmlsdGVyOmJsdXIoOTBweCk7YW5pbWF0aW9uOm9mIDlzIGVhc2UtaW4tb3V0IGluZmluaXRlO3BvaW50ZXItZXZlbnRzOm5vbmV9Ci5vMXt3aWR0aDo0NjBweDtoZWlnaHQ6NDYwcHg7YmFja2dyb3VuZDpyZ2JhKDI1NSwwLDEyOCwuMDkpO3RvcDotMTIlO2xlZnQ6LTglO2FuaW1hdGlvbi1kZWxheTowc30KLm8ye3dpZHRoOjMyMHB4O2hlaWdodDozMjBweDtiYWNrZ3JvdW5kOnJnYmEoMCwyNDUsMjU1LC4wNyk7Ym90dG9tOjA7cmlnaHQ6MDthbmltYXRpb24tZGVsYXk6LTVzfQpAa2V5ZnJhbWVzIG9mezAlLDEwMCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCkgc2NhbGUoMSl9NTAle3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0yOHB4KSBzY2FsZSgxLjA1KX19Ci5pbm5lcntwb3NpdGlvbjpyZWxhdGl2ZTt6LWluZGV4OjE7d2lkdGg6MTAwJTttYXgtd2lkdGg6ODIwcHg7bWFyZ2luOjAgYXV0bzt0ZXh0LWFsaWduOmNlbnRlcn0KQGtleWZyYW1lcyBmdXtmcm9te29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxNHB4KX10b3tvcGFjaXR5OjE7dHJhbnNmb3JtOm5vbmV9fQpAa2V5ZnJhbWVzIGdsaXRjaHswJSw5MCUsMTAwJXt0cmFuc2Zvcm06bm9uZTtmaWx0ZXI6bm9uZX05MSV7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtM3B4LDApO2ZpbHRlcjpkcm9wLXNoYWRvdygzcHggMCB2YXIoLS1yZWQpKX05MiV7dHJhbnNmb3JtOnRyYW5zbGF0ZSgzcHgsMCk7ZmlsdGVyOmRyb3Atc2hhZG93KC0zcHggMCB2YXIoLS1jeSkpfTkzJSw5NSV7dHJhbnNmb3JtOm5vbmU7ZmlsdGVyOm5vbmV9OTQle3RyYW5zZm9ybTp0cmFuc2xhdGUoMnB4LC0xcHgpO2ZpbHRlcjpkcm9wLXNoYWRvdygtMnB4IDAgdmFyKC0tcmVkKSl9fQoubWV7Zm9udC1mYW1pbHk6J1ByZXNzIFN0YXJ0IDJQJyxtb25vc3BhY2U7Zm9udC1zaXplOi40NHJlbTtjb2xvcjp2YXIoLS1jeSk7bGV0dGVyLXNwYWNpbmc6LjI1ZW07bWFyZ2luLWJvdHRvbTouN3JlbTtvcGFjaXR5OjA7YW5pbWF0aW9uOmZ1IC43cyAuMXMgZm9yd2FyZHN9Ci5tdHtmb250LWZhbWlseTonUHJlc3MgU3RhcnQgMlAnLG1vbm9zcGFjZTtmb250LXNpemU6Y2xhbXAoMi41cmVtLDh2dyw1cmVtKTtjb2xvcjp2YXIoLS15KTtsaW5lLWhlaWdodDoxO3RleHQtc2hhZG93OjAgMCAzNXB4IHJnYmEoMjU1LDIzMCwwLC45KSwwIDAgNzBweCByZ2JhKDI1NSwyMzAsMCwuNCk7YW5pbWF0aW9uOmdsaXRjaCA1cyBpbmZpbml0ZSxmdSAuN3MgLjE1cyBib3RoO21hcmdpbi1ib3R0b206LjNyZW19Ci5tc3Vie2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouNDJyZW07Y29sb3I6dmFyKC0tbXV0ZWQpO2xldHRlci1zcGFjaW5nOi4xMmVtO21hcmdpbi1ib3R0b206MS4ycmVtO29wYWNpdHk6MDthbmltYXRpb246ZnUgLjdzIC4yNXMgZm9yd2FyZHN9Ci5zZWMtbGFiZWx7Zm9udC1mYW1pbHk6J1ByZXNzIFN0YXJ0IDJQJyxtb25vc3BhY2U7Zm9udC1zaXplOi4zOHJlbTtjb2xvcjp2YXIoLS1tdXRlZCk7bGV0dGVyLXNwYWNpbmc6LjE4ZW07ZGlzcGxheTpibG9jazttYXJnaW4tYm90dG9tOi41NXJlbTt0ZXh0LWFsaWduOmxlZnR9Ci8qIE5hbWUgKyBUZWFtICovCi5yb3cxe2Rpc3BsYXk6ZmxleDtnYXA6LjdyZW07YWxpZ24taXRlbXM6ZmxleC1lbmQ7anVzdGlmeS1jb250ZW50OmNlbnRlcjttYXJnaW4tYm90dG9tOjFyZW07ZmxleC13cmFwOndyYXA7b3BhY2l0eTowO2FuaW1hdGlvbjpmdSAuN3MgLjNzIGZvcndhcmRzfQoubml7YmFja2dyb3VuZDp2YXIoLS1zdXJmKTtib3JkZXI6MnB4IHNvbGlkIHZhcigtLWJkcik7Y29sb3I6dmFyKC0tdHh0KTtmb250LWZhbWlseTonQmFybG93IENvbmRlbnNlZCcsc2Fucy1zZXJpZjtmb250LXdlaWdodDo3MDA7Zm9udC1zaXplOjEuMXJlbTtwYWRkaW5nOi41cmVtIC45cmVtO291dGxpbmU6bm9uZTt3aWR0aDoxODBweDtsZXR0ZXItc3BhY2luZzouMDVlbTt0cmFuc2l0aW9uOmJvcmRlci1jb2xvciAuMnN9Ci5uaTpmb2N1c3tib3JkZXItY29sb3I6dmFyKC0teSl9Lm5pOjpwbGFjZWhvbGRlcntjb2xvcjp2YXIoLS1tdXRlZCl9Ci50ZWFtLXBhaXJ7ZGlzcGxheTpmbGV4O2dhcDouNHJlbX0KLmJ0e2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouNDJyZW07bGV0dGVyLXNwYWNpbmc6LjA0ZW07cGFkZGluZzouNjVyZW0gMXJlbTtib3JkZXI6MnB4IHNvbGlkO2JhY2tncm91bmQ6dHJhbnNwYXJlbnQ7Y3Vyc29yOnBvaW50ZXI7dHJhbnNpdGlvbjphbGwgLjJzO2NsaXAtcGF0aDpwb2x5Z29uKDhweCAwJSwxMDAlIDAlLGNhbGMoMTAwJSAtIDhweCkgMTAwJSwwJSAxMDAlKX0KLmJ0LXJ7Ym9yZGVyLWNvbG9yOnZhcigtLXJlZCk7Y29sb3I6dmFyKC0tcmVkKX0uYnQtcjpob3ZlciwuYnQtci5zZWx7YmFja2dyb3VuZDp2YXIoLS1yZWQpO2NvbG9yOiNmZmY7Ym94LXNoYWRvdzowIDAgMjhweCByZ2JhKDI1NSw0OSw0OSwuNSl9Ci5idC1ie2JvcmRlci1jb2xvcjp2YXIoLS1ibHVlKTtjb2xvcjp2YXIoLS1ibHVlKX0uYnQtYjpob3ZlciwuYnQtYi5zZWx7YmFja2dyb3VuZDp2YXIoLS1ibHVlKTtjb2xvcjojZmZmO2JveC1zaGFkb3c6MCAwIDI4cHggcmdiYSgzMCwxNDQsMjU1LC41KX0KLyogTW9kZXMgKi8KLm1vZGVzLWdyaWR7ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczpyZXBlYXQoNSwxZnIpO2dhcDouNXJlbTttYXJnaW4tYm90dG9tOjFyZW07b3BhY2l0eTowO2FuaW1hdGlvbjpmdSAuN3MgLjM4cyBmb3J3YXJkc30KLm1je2JvcmRlcjoycHggc29saWQgdmFyKC0tYmRyKTtwYWRkaW5nOi42NXJlbSAuNHJlbTtjdXJzb3I6cG9pbnRlcjt0cmFuc2l0aW9uOmFsbCAuMnM7dGV4dC1hbGlnbjpjZW50ZXJ9Ci5tYzpob3Zlcntib3JkZXItY29sb3I6cmdiYSgyNTUsMjMwLDAsLjQ1KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMnB4KX0ubWMuc2Vse2JvcmRlci1jb2xvcjp2YXIoLS15KTtiYWNrZ3JvdW5kOnJnYmEoMjU1LDIzMCwwLC4wNil9Ci5tYy1pY29ue2ZvbnQtc2l6ZToxLjVyZW07ZGlzcGxheTpibG9jazttYXJnaW4tYm90dG9tOi4zcmVtfQoubWMtbmFtZXtmb250LWZhbWlseTonUHJlc3MgU3RhcnQgMlAnLG1vbm9zcGFjZTtmb250LXNpemU6LjNyZW07Y29sb3I6dmFyKC0teSk7ZGlzcGxheTpibG9jaztsZXR0ZXItc3BhY2luZzouMDRlbTttYXJnaW4tYm90dG9tOi4yNXJlbTtsaW5lLWhlaWdodDoxLjV9Ci5tYy1kZXNje2ZvbnQtc2l6ZTouNzVyZW07Y29sb3I6dmFyKC0tbXV0ZWQpO2xpbmUtaGVpZ2h0OjEuM30KLyogU2tpbiBncmlkICovCi5zZ3tkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdCg2LDFmcik7Z2FwOi41cmVtO21hcmdpbi1ib3R0b206MXJlbTtvcGFjaXR5OjA7YW5pbWF0aW9uOmZ1IC43cyAuNDVzIGZvcndhcmRzfQouc2t7Ym9yZGVyOjJweCBzb2xpZCB2YXIoLS1iZHIpO3BhZGRpbmc6LjVyZW0gLjI1cmVtO2N1cnNvcjpwb2ludGVyO3RyYW5zaXRpb246YWxsIC4ycztkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6LjNyZW19Ci5zazpob3Zlcntib3JkZXItY29sb3I6cmdiYSgyNTUsMjMwLDAsLjQ1KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMnB4KX0uc2suc2Vse2JvcmRlci1jb2xvcjp2YXIoLS15KTtiYWNrZ3JvdW5kOnJnYmEoMjU1LDIzMCwwLC4wNil9Ci5zcHt3aWR0aDozMHB4O2hlaWdodDozMHB4O2JvcmRlci1yYWRpdXM6NTAlO2JvcmRlcjozcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMSk7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2ZvbnQtc2l6ZTouOXJlbX0KLnNue2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouMjhyZW07Y29sb3I6cmdiYSgyNTUsMjU1LDI1NSwuNyk7bGV0dGVyLXNwYWNpbmc6LjA1ZW19Ci8qIEd1biBncmlkICovCi5ncntkaXNwbGF5OmZsZXg7Z2FwOi40NXJlbTtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO21hcmdpbi1ib3R0b206MXJlbTtmbGV4LXdyYXA6d3JhcDtvcGFjaXR5OjA7YW5pbWF0aW9uOmZ1IC43cyAuNTJzIGZvcndhcmRzfQouZ2N7Ym9yZGVyOjJweCBzb2xpZCB2YXIoLS1iZHIpO3BhZGRpbmc6LjU1cmVtIC40cmVtO2N1cnNvcjpwb2ludGVyO3RyYW5zaXRpb246YWxsIC4yczt0ZXh0LWFsaWduOmNlbnRlcjttaW4td2lkdGg6MTAwcHg7ZmxleDoxO21heC13aWR0aDoxMzBweH0KLmdjOmhvdmVye2JvcmRlci1jb2xvcjpyZ2JhKDI1NSwyMzAsMCwuNCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTJweCl9LmdjLnNlbHtib3JkZXItY29sb3I6dmFyKC0teSk7YmFja2dyb3VuZDpyZ2JhKDI1NSwyMzAsMCwuMDYpfQouZ25hbWV7Zm9udC1mYW1pbHk6J1ByZXNzIFN0YXJ0IDJQJyxtb25vc3BhY2U7Zm9udC1zaXplOi4zMnJlbTtsZXR0ZXItc3BhY2luZzouMDRlbTtkaXNwbGF5OmJsb2NrO21hcmdpbi1ib3R0b206LjRyZW19Ci5zcm93e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOi4zcmVtO21hcmdpbi1ib3R0b206LjE4cmVtfQouc2xie2ZvbnQtc2l6ZTouN3JlbTtjb2xvcjp2YXIoLS1tdXRlZCk7bWluLXdpZHRoOjIwcHg7Zm9udC13ZWlnaHQ6NzAwfQoucGlwc3tkaXNwbGF5OmZsZXg7Z2FwOjJweH0ucGlwe3dpZHRoOjdweDtoZWlnaHQ6NXB4O2JvcmRlci1yYWRpdXM6MXB4fQouYnB7Zm9udC1mYW1pbHk6J1ByZXNzIFN0YXJ0IDJQJyxtb25vc3BhY2U7Zm9udC1zaXplOi41NXJlbTtsZXR0ZXItc3BhY2luZzouMWVtO2JhY2tncm91bmQ6dmFyKC0teSk7Y29sb3I6IzAwMDtwYWRkaW5nOi44NXJlbSAyLjhyZW07Ym9yZGVyOm5vbmU7Y3Vyc29yOnBvaW50ZXI7Y2xpcC1wYXRoOnBvbHlnb24oMTJweCAwJSwxMDAlIDAlLGNhbGMoMTAwJSAtIDEycHgpIDEwMCUsMCUgMTAwJSk7dHJhbnNpdGlvbjp0cmFuc2Zvcm0gLjJzLGZpbHRlciAuMnM7dmlzaWJpbGl0eTpoaWRkZW47bWFyZ2luLWJvdHRvbToxcmVtfQouYnAuc2hvd3t2aXNpYmlsaXR5OnZpc2libGV9LmJwOmhvdmVye3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0zcHgpO2ZpbHRlcjpicmlnaHRuZXNzKDEuMTUpfQouY3Rye2Rpc3BsYXk6ZmxleDtnYXA6MS4zcmVtO2p1c3RpZnktY29udGVudDpjZW50ZXI7ZmxleC13cmFwOndyYXA7b3BhY2l0eTowO2FuaW1hdGlvbjpmdSAuN3MgLjY1cyBmb3J3YXJkc30KLmNpe2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouMzJyZW07Y29sb3I6dmFyKC0tbXV0ZWQpO3RleHQtYWxpZ246Y2VudGVyO2xpbmUtaGVpZ2h0OjIuMX0Ka2Jke2Rpc3BsYXk6aW5saW5lLWJsb2NrO2JhY2tncm91bmQ6dmFyKC0tc3VyZik7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1iZHIpO3BhZGRpbmc6LjFyZW0gLjNyZW07Ym9yZGVyLXJhZGl1czoycHg7Y29sb3I6cmdiYSgyNTUsMjU1LDI1NSwuNjUpO2ZvbnQtZmFtaWx5OmluaGVyaXR9CgovKiDilIDilIAgR0FNRSDilIDilIAgKi8KI3MtZ2FtZXtwYWRkaW5nOjA7anVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnQ7YWxpZ24taXRlbXM6ZmxleC1zdGFydDtvdmVyZmxvdzpoaWRkZW59CiNnY3twb3NpdGlvbjpmaXhlZDtpbnNldDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7ZGlzcGxheTpibG9jaztjdXJzb3I6Y3Jvc3NoYWlyfQojaHVke3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7cG9pbnRlci1ldmVudHM6bm9uZTt6LWluZGV4OjEwfQoKLyogU2NvcmUgYmFyICovCiNoc3twb3NpdGlvbjphYnNvbHV0ZTt0b3A6MXJlbTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxcmVtO2JhY2tncm91bmQ6cmdiYSg1LDUsOCwuOTIpO2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMDYpO3BhZGRpbmc6LjU1cmVtIDEuNXJlbTtiYWNrZHJvcC1maWx0ZXI6Ymx1cigxMHB4KTt3aGl0ZS1zcGFjZTpub3dyYXB9Ci5zbjJ7Zm9udC1mYW1pbHk6J1ByZXNzIFN0YXJ0IDJQJyxtb25vc3BhY2U7Zm9udC1zaXplOjEuNHJlbTtsaW5lLWhlaWdodDoxO3RyYW5zaXRpb246YWxsIC4zc30KLnNuMi5yZWR7Y29sb3I6dmFyKC0tcmVkKTt0ZXh0LXNoYWRvdzowIDAgMTRweCByZ2JhKDI1NSw0OSw0OSwuNyl9Ci5zbjIuYmx1ZXtjb2xvcjp2YXIoLS1ibHVlKTt0ZXh0LXNoYWRvdzowIDAgMTRweCByZ2JhKDMwLDE0NCwyNTUsLjcpfQouc24yLmZmYXtjb2xvcjp2YXIoLS15KTt0ZXh0LXNoYWRvdzowIDAgMTRweCByZ2JhKDI1NSwyMzAsMCwuNyl9Ci5zc2Vwe2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouMzhyZW07Y29sb3I6dmFyKC0tbXV0ZWQpO3RleHQtYWxpZ246Y2VudGVyO2xpbmUtaGVpZ2h0OjEuOTtsZXR0ZXItc3BhY2luZzouMDZlbX0KI2htb2Rle2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouMzZyZW07Y29sb3I6cmdiYSgyNTUsMjU1LDI1NSwuMyk7cG9zaXRpb246YWJzb2x1dGU7dG9wOi4yNXJlbTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTt3aGl0ZS1zcGFjZTpub3dyYXB9CgovKiBMZWZ0IEhVRCAqLwojaGx7cG9zaXRpb246YWJzb2x1dGU7dG9wOjFyZW07bGVmdDoxcmVtO2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouMzRyZW07Y29sb3I6dmFyKC0tbXV0ZWQpO2JhY2tncm91bmQ6cmdiYSg1LDUsOCwuODgpO2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMDQpO3BhZGRpbmc6LjRyZW0gLjY1cmVtO2xpbmUtaGVpZ2h0OjIuMjtsZXR0ZXItc3BhY2luZzouMDVlbX0KI2hsIC52e2NvbG9yOnZhcigtLXkpfQoKLyogS2lsbCBmZWVkICovCiNoZmVlZHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MXJlbTtyaWdodDoxcmVtO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47Z2FwOi4yOHJlbTthbGlnbi1pdGVtczpmbGV4LWVuZDttYXgtd2lkdGg6MjQwcHh9Ci5rZntmb250LWZhbWlseTonUHJlc3MgU3RhcnQgMlAnLG1vbm9zcGFjZTtmb250LXNpemU6LjMzcmVtO3BhZGRpbmc6LjI1cmVtIC41NXJlbTtiYWNrZ3JvdW5kOnJnYmEoNSw1LDgsLjkyKTtib3JkZXItcmlnaHQ6M3B4IHNvbGlkO2xldHRlci1zcGFjaW5nOi4wMmVtO3doaXRlLXNwYWNlOm5vd3JhcDthbmltYXRpb246a2ZpIC4zcyBlYXNlO21heC13aWR0aDoxMDAlO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzfQoua2YucmVke2JvcmRlci1jb2xvcjp2YXIoLS1yZWQpfS5rZi5ibHVle2JvcmRlci1jb2xvcjp2YXIoLS1ibHVlKX0ua2YuZmZhe2JvcmRlci1jb2xvcjp2YXIoLS15KX0KLmtre2NvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjkpfS5rdntjb2xvcjp2YXIoLS1tdXRlZCl9LmtzZXB7Y29sb3I6dmFyKC0teSl9CkBrZXlmcmFtZXMga2Zpe2Zyb217b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDE2cHgpfXRve29wYWNpdHk6MTt0cmFuc2Zvcm06bm9uZX19CgovKiBCb3R0b20gSFVEICovCiNoYm90e3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbToxLjJyZW07bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOi4zNXJlbX0KI2hocHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDouNHJlbTtiYWNrZ3JvdW5kOnJnYmEoNSw1LDgsLjg4KTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjA0KTtwYWRkaW5nOi40cmVtIC45cmVtfQouaHBse2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouMzRyZW07Y29sb3I6dmFyKC0tbXV0ZWQpO2xldHRlci1zcGFjaW5nOi4xZW07bWFyZ2luLXJpZ2h0Oi4ycmVtfQouaGVhcnR7Zm9udC1zaXplOjEuMXJlbTt0cmFuc2l0aW9uOmFsbCAuMjJzfS5oZWFydC5le29wYWNpdHk6LjEzO3RyYW5zZm9ybTpzY2FsZSguNzUpfQouc2hpZWxkLXBpcHtmb250LXNpemU6MXJlbTtjb2xvcjp2YXIoLS1jeSl9CiNoYW1tb3tkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDouNnJlbTtiYWNrZ3JvdW5kOnJnYmEoNSw1LDgsLjg4KTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjA0KTtwYWRkaW5nOi4zNXJlbSAuOXJlbX0KI2hnbmFtZXtmb250LWZhbWlseTonUHJlc3MgU3RhcnQgMlAnLG1vbm9zcGFjZTtmb250LXNpemU6LjM0cmVtO2xldHRlci1zcGFjaW5nOi4wNmVtfQojaGJ1bGxldHN7ZGlzcGxheTpmbGV4O2dhcDoycHg7YWxpZ24taXRlbXM6Y2VudGVyO21heC13aWR0aDoxNjBweDtmbGV4LXdyYXA6d3JhcH0KLmJwaXB7d2lkdGg6NHB4O2hlaWdodDo5cHg7Ym9yZGVyLXJhZGl1czoxcHg7dHJhbnNpdGlvbjpvcGFjaXR5IC4xc30KI2hyZWxvYWR7Zm9udC1mYW1pbHk6J1ByZXNzIFN0YXJ0IDJQJyxtb25vc3BhY2U7Zm9udC1zaXplOi4zNHJlbTtjb2xvcjp2YXIoLS15KTtsZXR0ZXItc3BhY2luZzouMDhlbTthbmltYXRpb246cnAgMXMgZWFzZS1pbi1vdXQgaW5maW5pdGV9CkBrZXlmcmFtZXMgcnB7MCUsMTAwJXtvcGFjaXR5OjF9NTAle29wYWNpdHk6LjN9fQovKiBQb3dlcnVwIGRpc3BsYXkgKi8KI2hwb3d7ZGlzcGxheTpmbGV4O2dhcDouM3JlbTtiYWNrZ3JvdW5kOnJnYmEoNSw1LDgsLjg4KTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjA0KTtwYWRkaW5nOi4zcmVtIC43cmVtO21pbi1oZWlnaHQ6MzJweDthbGlnbi1pdGVtczpjZW50ZXJ9Ci5wb3ctcGlwe2ZvbnQtc2l6ZToxcmVtO3RyYW5zaXRpb246YWxsIC4zc30KLyogR3VuIGdhbWUgd2VhcG9uICovCiNoZ3Vue2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouMzJyZW07Y29sb3I6dmFyKC0teSk7YmFja2dyb3VuZDpyZ2JhKDUsNSw4LC44OCk7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC4wNCk7cGFkZGluZzouM3JlbSAuN3JlbTtsZXR0ZXItc3BhY2luZzouMDdlbTtkaXNwbGF5Om5vbmV9CgovKiBNYXAgbmFtZSAqLwojbWFwbmFtZXtwb3NpdGlvbjphYnNvbHV0ZTtib3R0b206MS4ycmVtO3JpZ2h0OjFyZW07Zm9udC1mYW1pbHk6J1ByZXNzIFN0YXJ0IDJQJyxtb25vc3BhY2U7Zm9udC1zaXplOi4zMnJlbTtjb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC4xOCk7bGV0dGVyLXNwYWNpbmc6LjA4ZW19CgovKiBLT1RIIHpvbmUgYmFyICovCiNrb3RoLWJhcntwb3NpdGlvbjphYnNvbHV0ZTt0b3A6NS41cmVtO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO2Rpc3BsYXk6bm9uZTtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6Y2VudGVyO2dhcDouM3JlbX0KI2tvdGgtYmFyLnNob3d7ZGlzcGxheTpmbGV4fQoua290aC10cmFja3t3aWR0aDoyNjBweDtoZWlnaHQ6MTBweDtiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsLjA2KTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJkcik7cG9zaXRpb246cmVsYXRpdmU7b3ZlcmZsb3c6aGlkZGVufQoua290aC1maWxsLXJ7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowO3RvcDowO2hlaWdodDoxMDAlO2JhY2tncm91bmQ6dmFyKC0tcmVkKTt0cmFuc2l0aW9uOndpZHRoIC4zc30KLmtvdGgtZmlsbC1ie3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjA7dG9wOjA7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZDp2YXIoLS1ibHVlKTt0cmFuc2l0aW9uOndpZHRoIC4zc30KLmtvdGgtbGFiZWx7Zm9udC1mYW1pbHk6J1ByZXNzIFN0YXJ0IDJQJyxtb25vc3BhY2U7Zm9udC1zaXplOi4zcmVtO2NvbG9yOnZhcigtLW11dGVkKTtsZXR0ZXItc3BhY2luZzouMWVtO2Rpc3BsYXk6ZmxleDtnYXA6MS41cmVtfQoua2wtcntjb2xvcjp2YXIoLS1yZWQpfS5rbC1ie2NvbG9yOnZhcigtLWJsdWUpfQoKLyogQ1RGIGZsYWdzICovCiNjdGYtaHVke3Bvc2l0aW9uOmFic29sdXRlO3RvcDo1LjVyZW07bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7ZGlzcGxheTpub25lO2dhcDoycmVtO2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouMzhyZW07YmFja2dyb3VuZDpyZ2JhKDUsNSw4LC44OCk7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC4wNCk7cGFkZGluZzouNHJlbSAxLjJyZW19CiNjdGYtaHVkLnNob3d7ZGlzcGxheTpmbGV4fQouY3RmLXJ7Y29sb3I6dmFyKC0tcmVkKX0uY3RmLWJ7Y29sb3I6dmFyKC0tYmx1ZSl9CgovKiBSZXNwYXduICovCiNocmVzcGF3bntwb3NpdGlvbjphYnNvbHV0ZTt0b3A6NTAlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGUoLTUwJSwtNTAlKTt0ZXh0LWFsaWduOmNlbnRlcjtkaXNwbGF5Om5vbmU7cG9pbnRlci1ldmVudHM6bm9uZX0KI2hyZXNwYXduLnNob3d7ZGlzcGxheTpibG9ja30KLnJzZHtmb250LWZhbWlseTonUHJlc3MgU3RhcnQgMlAnLG1vbm9zcGFjZTtmb250LXNpemU6LjU1cmVtO2NvbG9yOnZhcigtLXJlZCk7bGV0dGVyLXNwYWNpbmc6LjJlbTttYXJnaW4tYm90dG9tOi42cmVtfQoucnNje2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTozLjVyZW07Y29sb3I6dmFyKC0teSk7dGV4dC1zaGFkb3c6MCAwIDQwcHggcmdiYSgyNTUsMjMwLDAsLjkpO2FuaW1hdGlvbjpwdSAxcyBlYXNlLWluLW91dCBpbmZpbml0ZX0KQGtleWZyYW1lcyBwdXswJSwxMDAle3RyYW5zZm9ybTpzY2FsZSgxKX01MCV7dHJhbnNmb3JtOnNjYWxlKDEuMDcpfX0KCi8qIEtpbGwgc3RyZWFrIGJhbm5lciAqLwojc3RyZWFrLWJhbm5lcntwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MzUlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO3BvaW50ZXItZXZlbnRzOm5vbmU7ZGlzcGxheTpub25lO3RleHQtYWxpZ246Y2VudGVyfQojc3RyZWFrLWJhbm5lci5zaG93e2Rpc3BsYXk6YmxvY2t9Ci5zYi10ZXh0e2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTpjbGFtcCguOHJlbSwyLjV2dywxLjJyZW0pO2NvbG9yOnZhcigtLXkpO3RleHQtc2hhZG93OjAgMCA0MHB4IHJnYmEoMjU1LDIzMCwwLC45KSwwIDAgODBweCByZ2JhKDI1NSwyMzAsMCwuNSk7bGV0dGVyLXNwYWNpbmc6LjFlbTthbmltYXRpb246c2JBbmltIC41cyBlYXNlfQpAa2V5ZnJhbWVzIHNiQW5pbXtmcm9te29wYWNpdHk6MDt0cmFuc2Zvcm06c2NhbGUoLjUpfXRve29wYWNpdHk6MTt0cmFuc2Zvcm06c2NhbGUoMSl9fQoKLyogUG93ZXJ1cCBwaWNrdXAgZmxhc2ggKi8KI3Bvdy1iYW5uZXJ7cG9zaXRpb246YWJzb2x1dGU7dG9wOjQwJTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTtwb2ludGVyLWV2ZW50czpub25lO2Rpc3BsYXk6bm9uZTt0ZXh0LWFsaWduOmNlbnRlcn0KI3Bvdy1iYW5uZXIuc2hvd3tkaXNwbGF5OmJsb2NrfQoucGItdGV4dHtmb250LWZhbWlseTonUHJlc3MgU3RhcnQgMlAnLG1vbm9zcGFjZTtmb250LXNpemU6LjU1cmVtO2NvbG9yOnZhcigtLWN5KTtsZXR0ZXItc3BhY2luZzouMWVtO2FuaW1hdGlvbjpzYkFuaW0gLjRzIGVhc2V9CgovKiDilIDilIAgRU5EIFNDUkVFTiDilIDilIAgKi8KI3MtZW5ke2JhY2tncm91bmQ6cmdiYSg1LDUsOCwuOTcpO2JhY2tkcm9wLWZpbHRlcjpibHVyKDIwcHgpO2p1c3RpZnktY29udGVudDpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyO292ZXJmbG93LXk6YXV0b30KLmV3dHtmb250LWZhbWlseTonUHJlc3MgU3RhcnQgMlAnLG1vbm9zcGFjZTtmb250LXNpemU6Y2xhbXAoMS4xcmVtLDR2dywyLjVyZW0pO21hcmdpbi1ib3R0b206LjRyZW07YW5pbWF0aW9uOmZ1IC41cyBlYXNlO3RleHQtYWxpZ246Y2VudGVyfQouZXd0LnJlZHtjb2xvcjp2YXIoLS1yZWQpO3RleHQtc2hhZG93OjAgMCA1MHB4IHJnYmEoMjU1LDQ5LDQ5LC44KX0KLmV3dC5ibHVle2NvbG9yOnZhcigtLWJsdWUpO3RleHQtc2hhZG93OjAgMCA1MHB4IHJnYmEoMzAsMTQ0LDI1NSwuOCl9Ci5ld3QueW91e2NvbG9yOnZhcigtLXkpO3RleHQtc2hhZG93OjAgMCA1MHB4IHJnYmEoMjU1LDIzMCwwLC44KX0KLmV3dC5mZmF7Y29sb3I6dmFyKC0tcHVycGxlKTt0ZXh0LXNoYWRvdzowIDAgNTBweCByZ2JhKDE2OCw4NSwyNDcsLjgpfQouZXN1Yntmb250LWZhbWlseTonUHJlc3MgU3RhcnQgMlAnLG1vbm9zcGFjZTtmb250LXNpemU6LjQycmVtO2NvbG9yOnZhcigtLW11dGVkKTtsZXR0ZXItc3BhY2luZzouMTVlbTttYXJnaW4tYm90dG9tOjEuNXJlbTt0ZXh0LWFsaWduOmNlbnRlcn0KLyogU2NvcmVib2FyZCAqLwouc2ItdGFibGV7d2lkdGg6MTAwJTttYXgtd2lkdGg6NjUwcHg7Ym9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlO21hcmdpbi1ib3R0b206MnJlbX0KLnNiLXRhYmxlIHRoe2ZvbnQtZmFtaWx5OidQcmVzcyBTdGFydCAyUCcsbW9ub3NwYWNlO2ZvbnQtc2l6ZTouMzJyZW07Y29sb3I6dmFyKC0tbXV0ZWQpO2xldHRlci1zcGFjaW5nOi4wOGVtO3BhZGRpbmc6LjVyZW0gLjdyZW07dGV4dC1hbGlnbjpsZWZ0O2JvcmRlci1ib3R0b206MnB4IHNvbGlkIHZhcigtLXkpfQouc2ItdGFibGUgdGR7cGFkZGluZzouNnJlbSAuN3JlbTtmb250LXNpemU6Ljk1cmVtO2ZvbnQtd2VpZ2h0OjcwMDtib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1iZHIpfQouc2ItdGFibGUgdHIuaGlnaGxpZ2h0IHRke2JhY2tncm91bmQ6cmdiYSgyNTUsMjMwLDAsLjA2KX0KLnNiLXRhYmxlIHRyLmhpZ2hsaWdodCB0ZDpmaXJzdC1jaGlsZHtib3JkZXItbGVmdDozcHggc29saWQgdmFyKC0teSl9Ci5zYi13aW57Y29sb3I6dmFyKC0teSl9LnNiLWtke2NvbG9yOnZhcigtLWN5KX0uc2Ita3tjb2xvcjp2YXIoLS1wayl9LnNiLXRlYW0tcntjb2xvcjp2YXIoLS1yZWQpfS5zYi10ZWFtLWJ7Y29sb3I6dmFyKC0tYmx1ZSl9Ci5iYXtmb250LWZhbWlseTonUHJlc3MgU3RhcnQgMlAnLG1vbm9zcGFjZTtmb250LXNpemU6LjU1cmVtO2xldHRlci1zcGFjaW5nOi4xZW07YmFja2dyb3VuZDp2YXIoLS15KTtjb2xvcjojMDAwO3BhZGRpbmc6Ljg1cmVtIDIuOHJlbTtib3JkZXI6bm9uZTtjdXJzb3I6cG9pbnRlcjtjbGlwLXBhdGg6cG9seWdvbigxMnB4IDAlLDEwMCUgMCUsY2FsYygxMDAlIC0gMTJweCkgMTAwJSwwJSAxMDAlKTt0cmFuc2l0aW9uOnRyYW5zZm9ybSAuMnMsZmlsdGVyIC4yc30KLmJhOmhvdmVye3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0zcHgpO2ZpbHRlcjpicmlnaHRuZXNzKDEuMSl9CiNmbGFzaHtwb3NpdGlvbjpmaXhlZDtpbnNldDowO3BvaW50ZXItZXZlbnRzOm5vbmU7ei1pbmRleDo1O29wYWNpdHk6MDt0cmFuc2l0aW9uOm9wYWNpdHkgLjEyc30KPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KPGRpdiBpZD0iZmxhc2giPjwvZGl2PgoKPCEtLSDilZDilZDilZAgTUVOVSDilZDilZDilZAgLS0+CjxkaXYgaWQ9InMtbWVudSIgY2xhc3M9InNjcmVlbiBhY3RpdmUiPgogIDxkaXYgY2xhc3M9Im9yYiBvMSI+PC9kaXY+PGRpdiBjbGFzcz0ib3JiIG8yIj48L2Rpdj4KICA8ZGl2IGNsYXNzPSJpbm5lciI+CiAgICA8cCBjbGFzcz0ibWUiPuKalCBSRUQgdnMgQkxVRSDCtyBTRUFTT04gMSBMSVZFIOKalDwvcD4KICAgIDxoMSBjbGFzcz0ibXQiPlJJVkFMUzwvaDE+CiAgICA8cCBjbGFzcz0ibXN1YiI+UElDSyBZT1VSIE1PREUgwrcgTE9BRCBPVVQgwrcgRE9NSU5BVEU8L3A+CgogICAgPGRpdiBjbGFzcz0icm93MSI+CiAgICAgIDxkaXY+PGxhYmVsIGNsYXNzPSJzZWMtbGFiZWwiPk5BTUU8L2xhYmVsPjxpbnB1dCBpZD0ibmkiIGNsYXNzPSJuaSIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9IkVOVEVSIE5BTUUiIG1heGxlbmd0aD0iMTIiIHNwZWxsY2hlY2s9ImZhbHNlIiBhdXRvY29tcGxldGU9Im9mZiIvPjwvZGl2PgogICAgICA8ZGl2IGlkPSJ0ZWFtLXBpY2siPjxsYWJlbCBjbGFzcz0ic2VjLWxhYmVsIj5URUFNPC9sYWJlbD48ZGl2IGNsYXNzPSJ0ZWFtLXBhaXIiPjxidXR0b24gY2xhc3M9ImJ0IGJ0LXIiIG9uY2xpY2s9InNlbFRlYW0oJ3JlZCcpIj7wn5S0IFJFRDwvYnV0dG9uPjxidXR0b24gY2xhc3M9ImJ0IGJ0LWIiIG9uY2xpY2s9InNlbFRlYW0oJ2JsdWUnKSI+8J+UtSBCTFVFPC9idXR0b24+PC9kaXY+PC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8bGFiZWwgY2xhc3M9InNlYy1sYWJlbCI+R0FNRSBNT0RFPC9sYWJlbD4KICAgIDxkaXYgY2xhc3M9Im1vZGVzLWdyaWQiIGlkPSJtZyI+PC9kaXY+CgogICAgPGxhYmVsIGNsYXNzPSJzZWMtbGFiZWwiPlNLSU48L2xhYmVsPgogICAgPGRpdiBjbGFzcz0ic2ciIGlkPSJzZyI+PC9kaXY+CgogICAgPGRpdiBpZD0iZ3VuLXJvdyI+PGxhYmVsIGNsYXNzPSJzZWMtbGFiZWwiPldFQVBPTjwvbGFiZWw+PGRpdiBjbGFzcz0iZ3IiIGlkPSJnciI+PC9kaXY+PC9kaXY+CgogICAgPGJ1dHRvbiBpZD0iYnAiIGNsYXNzPSJicCIgb25jbGljaz0ic3RhcnRHYW1lKCkiPuKaoSBFTlRFUiBBUkVOQTwvYnV0dG9uPgoKICAgIDxkaXYgY2xhc3M9ImN0ciI+CiAgICAgIDxkaXYgY2xhc3M9ImNpIj48a2JkPldBU0Q8L2tiZD48YnI+TU9WRTwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJjaSI+TU9VU0U8YnI+QUlNPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9ImNpIj48a2JkPkxNQjwva2JkPjxicj5TSE9PVDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJjaSI+PGtiZD5GPC9rYmQ+LzxrYmQ+Uk1CPC9rYmQ+PGJyPlNXT1JEPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9ImNpIj48a2JkPlI8L2tiZD48YnI+UkVMT0FEPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9ImNpIj48a2JkPkU8L2tiZD48YnI+R1JBQiBGTEFHPC9kaXY+CiAgICA8L2Rpdj4KICA8L2Rpdj4KPC9kaXY+Cgo8IS0tIOKVkOKVkOKVkCBHQU1FIOKVkOKVkOKVkCAtLT4KPGRpdiBpZD0icy1nYW1lIiBjbGFzcz0ic2NyZWVuIj4KICA8Y2FudmFzIGlkPSJnYyI+PC9jYW52YXM+CiAgPGRpdiBpZD0iaHVkIj4KICAgIDxkaXYgaWQ9ImhzIj4KICAgICAgPHNwYW4gaWQ9Imhtb2RlIj48L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJzbjIgcmVkIiBpZD0ic3IiPjA8L3NwYW4+CiAgICAgIDxkaXYgY2xhc3M9InNzZXAiIGlkPSJzc2VwIj5LSUxMUzxicj5UTyA1PC9kaXY+CiAgICAgIDxzcGFuIGNsYXNzPSJzbjIgYmx1ZSIgaWQ9InNiMiI+MDwvc3Bhbj4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0iaGwiPk1ZIEtJTExTICZuYnNwOzxzcGFuIGNsYXNzPSJ2IiBpZD0ibWsiPjA8L3NwYW4+PGJyPkRFQVRIUyAmbmJzcDsmbmJzcDs8c3BhbiBjbGFzcz0idiIgaWQ9Im1kIj4wPC9zcGFuPjxicj5TVFJFQUsgJm5ic3A7Jm5ic3A7PHNwYW4gY2xhc3M9InYiIGlkPSJtcyI+MDwvc3Bhbj48L2Rpdj4KICAgIDxkaXYgaWQ9ImhmZWVkIj48L2Rpdj4KICAgIDxkaXYgaWQ9ImtvdGgtYmFyIj48ZGl2IGNsYXNzPSJrb3RoLWxhYmVsIj48c3BhbiBjbGFzcz0ia2wtciIgaWQ9ImtyLXMiPjBzPC9zcGFuPjxzcGFuIHN0eWxlPSJjb2xvcjp2YXIoLS1tdXRlZCkiPlpPTkU8L3NwYW4+PHNwYW4gY2xhc3M9ImtsLWIiIGlkPSJrYi1zIj4wczwvc3Bhbj48L2Rpdj48ZGl2IGNsYXNzPSJrb3RoLXRyYWNrIj48ZGl2IGNsYXNzPSJrb3RoLWZpbGwtciIgaWQ9ImtyLWZpbGwiIHN0eWxlPSJ3aWR0aDowJSI+PC9kaXY+PGRpdiBjbGFzcz0ia290aC1maWxsLWIiIGlkPSJrYi1maWxsIiBzdHlsZT0id2lkdGg6MCUiPjwvZGl2PjwvZGl2PjwvZGl2PgogICAgPGRpdiBpZD0iY3RmLWh1ZCI+PHNwYW4gY2xhc3M9ImN0Zi1yIj7wn5qpIFJFRDogPHNwYW4gaWQ9ImN0Zi1yIj4wPC9zcGFuPjwvc3Bhbj48c3BhbiBjbGFzcz0iY3RmLWIiPvCfj7MgQkxVRTogPHNwYW4gaWQ9ImN0Zi1iIj4wPC9zcGFuPjwvc3Bhbj48L2Rpdj4KICAgIDxkaXYgaWQ9Imhib3QiPgogICAgICA8ZGl2IGlkPSJoaHAiPjxzcGFuIGNsYXNzPSJocGwiPkhQPC9zcGFuPjxzcGFuIGNsYXNzPSJoZWFydCIgaWQ9ImgxIj7inaTvuI88L3NwYW4+PHNwYW4gY2xhc3M9ImhlYXJ0IiBpZD0iaDIiPuKdpO+4jzwvc3Bhbj48c3BhbiBjbGFzcz0iaGVhcnQiIGlkPSJoMyI+4p2k77iPPC9zcGFuPjxzcGFuIGlkPSJzaGllbGQtZGlzcGxheSI+PC9zcGFuPjwvZGl2PgogICAgICA8ZGl2IGlkPSJocG93Ij48L2Rpdj4KICAgICAgPGRpdiBpZD0iaGFtbW8iPjxzcGFuIGlkPSJoZ25hbWUiPlBJU1RPTDwvc3Bhbj48ZGl2IGlkPSJoYnVsbGV0cyI+PC9kaXY+PHNwYW4gaWQ9ImhyZWxvYWQiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPlJFTE9BRElOR+KApjwvc3Bhbj48L2Rpdj4KICAgICAgPGRpdiBpZD0iaGd1biI+PC9kaXY+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9Im1hcG5hbWUiPjwvZGl2PgogICAgPGRpdiBpZD0iaHJlc3Bhd24iPjxkaXYgY2xhc3M9InJzZCI+4oCUIFlPVSBESUVEIOKAlDwvZGl2PjxkaXYgY2xhc3M9InJzYyIgaWQ9InJzYyI+MzwvZGl2PjwvZGl2PgogICAgPGRpdiBpZD0ic3RyZWFrLWJhbm5lciI+PGRpdiBjbGFzcz0ic2ItdGV4dCIgaWQ9InNiLXRleHQiPjwvZGl2PjwvZGl2PgogICAgPGRpdiBpZD0icG93LWJhbm5lciI+PGRpdiBjbGFzcz0icGItdGV4dCIgaWQ9InBiLXRleHQiPjwvZGl2PjwvZGl2PgogIDwvZGl2Pgo8L2Rpdj4KCjwhLS0g4pWQ4pWQ4pWQIEVORCDilZDilZDilZAgLS0+CjxkaXYgaWQ9InMtZW5kIiBjbGFzcz0ic2NyZWVuIj4KICA8ZGl2IGNsYXNzPSJld3QiIGlkPSJldCI+UkVEIFdJTlMhPC9kaXY+CiAgPGRpdiBjbGFzcz0iZXN1YiIgaWQ9ImVzIj5ST1VORCBPVkVSPC9kaXY+CiAgPHRhYmxlIGNsYXNzPSJzYi10YWJsZSIgaWQ9InNiLXRhYmxlIj48dGhlYWQ+PHRyPjx0aD4jPC90aD48dGg+UExBWUVSPC90aD48dGg+VEVBTTwvdGg+PHRoPks8L3RoPjx0aD5EPC90aD48dGg+Sy9EPC90aD48dGg+U0NPUkU8L3RoPjwvdHI+PC90aGVhZD48dGJvZHkgaWQ9InNiLWJvZHkiPjwvdGJvZHk+PC90YWJsZT4KICA8YnV0dG9uIGNsYXNzPSJiYSIgb25jbGljaz0icGxheUFnYWluKCkiPlBMQVkgQUdBSU4g4pqhPC9idXR0b24+CjwvZGl2PgoKPHNjcmlwdD4KLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCi8vICBEQVRBCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkApjb25zdCBNT0RFUyA9IFsKICB7aWQ6J3RkbScsICBuYW1lOidURUFNIERNJywgICAgICAgaWNvbjon4pqU77iPJywgIGRlc2M6J0ZpcnN0IHRlYW0gdG8gMzAga2lsbHMnLCB0YXJnZXQ6MzAsIHRlYW1zOnRydWUsICBmZmFTY29yZTpmYWxzZX0sCiAge2lkOidmZmEnLCAgbmFtZTonRlJFRSBGT1IgQUxMJywgIGljb246J/CfkoAnLCAgZGVzYzonRXZlcnkgbWFuIGZvciBoaW1zZWxmLiBGaXJzdCB0byA4IGtpbGxzJywgdGFyZ2V0OjgsICB0ZWFtczpmYWxzZSwgZmZhU2NvcmU6dHJ1ZX0sCiAge2lkOidrb3RoJywgbmFtZTonS0lORyBPRiBISUxMJywgIGljb246J/CfkZEnLCAgZGVzYzonSG9sZCBjZW50ZXIgem9uZS4gRmlyc3QgdG8gMjAgc2Vjb25kcycsIHRhcmdldDoyMCwgdGVhbXM6dHJ1ZSwgIGZmYVNjb3JlOmZhbHNlfSwKICB7aWQ6J2N0ZicsICBuYW1lOidDQVBUVVJFIEZMQUcnLCAgaWNvbjon8J+aqScsICBkZXNjOidTdGVhbCB0aGUgZW5lbXkgZmxhZy4gRmlyc3QgdG8gMyBjYXBzJywgdGFyZ2V0OjMsICB0ZWFtczp0cnVlLCAgZmZhU2NvcmU6ZmFsc2V9LAogIHtpZDonZ3VuJywgIG5hbWU6J0dVTiBHQU1FJywgICAgICBpY29uOifwn5SrJywgIGRlc2M6J0VhY2gga2lsbCA9IG5leHQgd2VhcG9uLiBGaXJzdCB0aHJvdWdoIGFsbCB3aW5zJywgdGFyZ2V0Om51bGwsdGVhbXM6ZmFsc2UsIGZmYVNjb3JlOmZhbHNlfSwKICB7aWQ6JzF2MScsICBuYW1lOicxVjEgRFVFTCcsICAgICAgIGljb246J/CfpYonLCAgZGVzYzonWW91IHZzIG9uZSBvcHBvbmVudC4gU21hbGwgYXJlbmEuIEZpcnN0IHRvIDUga2lsbHMnLCB0YXJnZXQ6NSwgIHRlYW1zOmZhbHNlLCBmZmFTY29yZTp0cnVlfSwKXTsKY29uc3QgU0tJTlMgPSBbCiAge2lkOidwaGFudG9tJyxib2R5Q29sOicjOEI1Q0Y2JyxhY2NDb2w6JyNDNEI1RkQnLGdsb3dDb2w6J3JnYmEoMTM5LDkyLDI0NiwuNyknLHNoYXBlOidyaW5ncycsZW1vamk6J/CfkbsnLG5hbWU6J1BIQU5UT00nfSwKICB7aWQ6J2RlbW9uJywgIGJvZHlDb2w6JyNEQzI2MjYnLGFjY0NvbDonI0ZDQTVBNScsZ2xvd0NvbDoncmdiYSgyMjAsMzgsMzgsLjcpJywgc2hhcGU6J2V5ZXMnLCBlbW9qaTon8J+YiCcsbmFtZTonREVNT04nfSwKICB7aWQ6J2dob3N0JywgIGJvZHlDb2w6JyM5NEEzQjgnLGFjY0NvbDonI0YxRjVGOScsZ2xvd0NvbDoncmdiYSgyMDAsMjEwLDIzMCwuNSknLHNoYXBlOidzb2Z0JywgZW1vamk6J/CfpI0nLG5hbWU6J0dIT1NUJ30sCiAge2lkOidibGF6ZScsICBib2R5Q29sOicjRjk3MzE2JyxhY2NDb2w6JyNGRUQ3QUEnLGdsb3dDb2w6J3JnYmEoMjQ5LDExNSwyMiwuNyknLHNoYXBlOidmaXJlJywgZW1vamk6J/CflKUnLG5hbWU6J0JMQVpFJ30sCiAge2lkOid2b2lkJywgICBib2R5Q29sOicjMzEyRTgxJyxhY2NDb2w6JyM4MThDRjgnLGdsb3dDb2w6J3JnYmEoOTksMTAyLDI0MSwuNyknLCBzaGFwZTonY3Jvc3MnLGVtb2ppOifimqsnLG5hbWU6J1ZPSUQnfSwKICB7aWQ6J3N0b3JtJywgIGJvZHlDb2w6JyMwODkxQjInLGFjY0NvbDonIzY3RThGOScsZ2xvd0NvbDoncmdiYSg4LDE0NSwxNzgsLjcpJywgIHNoYXBlOid6YXAnLCAgZW1vamk6J+KaoScsbmFtZTonU1RPUk0nfSwKXTsKY29uc3QgR1VOUyA9IFsKICB7aWQ6J3Bpc3RvbCcsIG5hbWU6J1BJU1RPTCcsIGNvbDonIzk0QTNCOCcsZG1nOjEscmF0ZTouNDIsc3BkOjYyMCxzcHJlYWQ6LjA3LG1heEFtbW86MTIscmVsb2FkOjEuMyxwZWxsZXRzOjEscmFuZ2U6MS41LHR3OjIsIGQ6MixmOjMsYTozLGljb246J/CflKsnfSwKICB7aWQ6J3NtZycsICAgIG5hbWU6J1NNRycsICAgIGNvbDonIzIyRDNFRScsZG1nOjEscmF0ZTouMDgsc3BkOjU2MCxzcHJlYWQ6LjE5LG1heEFtbW86MzAscmVsb2FkOjIuMCxwZWxsZXRzOjEscmFuZ2U6MS4yLHR3OjEuNSxkOjEsZjo1LGE6NSxpY29uOifwn5SnJ30sCiAge2lkOidzaG90Z3VuJyxuYW1lOidTSE9UR1VOJyxjb2w6JyNGOTczMTYnLGRtZzoxLHJhdGU6Ljg4LHNwZDo0MjAsc3ByZWFkOi4zNCxtYXhBbW1vOjYsIHJlbG9hZDoxLjkscGVsbGV0czo1LHJhbmdlOi41NSx0dzoyLjUsZDo1LGY6MSxhOjEsaWNvbjon8J+SpSd9LAogIHtpZDonc25pcGVyJywgbmFtZTonU05JUEVSJywgY29sOicjQTNFNjM1JyxkbWc6MyxyYXRlOjEuMyxzcGQ6MTE1MCxzcHJlYWQ6LjAxLG1heEFtbW86NSxyZWxvYWQ6Mi4yLHBlbGxldHM6MSxyYW5nZToyLjAsdHc6MywgIGQ6NSxmOjEsYToxLGljb246J/Cfjq8nfSwKICB7aWQ6J2Fzc2F1bHQnLG5hbWU6J0FTU0FVTFQnLGNvbDonI0ZCNzE4NScsZG1nOjEscmF0ZTouMTksc3BkOjY4MCxzcHJlYWQ6LjEwLG1heEFtbW86MjAscmVsb2FkOjEuNixwZWxsZXRzOjEscmFuZ2U6MS40LHR3OjIsIGQ6MixmOjQsYTo0LGljb246J/CflLQnfSwKXTsKY29uc3QgR1VOX09SREVSID0gWydwaXN0b2wnLCdzbWcnLCdzaG90Z3VuJywnYXNzYXVsdCcsJ3NuaXBlciddOwpjb25zdCBTVFJFQUtfTkFNRVMgPSB7MjonRE9VQkxFIEtJTEwhJywzOidUUklQTEUgS0lMTCEnLDQ6J1FVQUQgS0lMTCEnLDU6J1JBTVBBR0UhIScsNjonVU5TVE9QUEFCTEUhISEnLDc6J0dPRExJS0UhISEhISd9Owpjb25zdCBQT1dfVFlQRVMgPSBbCiAge2lkOidoZWFsdGgnLGljb246J+KdpO+4jycsIGNvbDonI0ZGMzEzMScsbGFiZWw6J0hFQUxUSCBCT09TVCd9LAogIHtpZDonc3BlZWQnLCBpY29uOifimqEnLCBjb2w6JyNGRkU2MDAnLGxhYmVsOidTUEVFRCBCT09TVCd9LAogIHtpZDonZGFtYWdlJyxpY29uOifwn5SlJywgY29sOicjRjk3MzE2JyxsYWJlbDonREFNQUdFIEFNUCd9LAogIHtpZDonc2hpZWxkJyxpY29uOifwn5uh77iPJywgY29sOicjMDBGNUZGJyxsYWJlbDonU0hJRUxEJ30sCl07CmNvbnN0IEJPVF9OQU1FUyA9IHsKICByZWQ6IFsnUkVBUEVSJywnQkxPT0RBWCcsJ1ZPUlRFWCcsJ0lORkVSTk8nLCdSQUdOQVInXSwKICBibHVlOlsnU1BFQ1RFUicsJ1BIQU5UT01fWCcsJ05PQ1RVQScsJ0NJUEhFUicsJ1dSQUlUSCddLAogIGZmYTogWydHSE9TVCcsJ1JPTklOJywnQVBFWCcsJ0JMQURFJywnUk9HVUUnLCdDSVBIRVInLCdWSVBFUicsJ1RIT1JOJ10sCn07CmNvbnN0IE1BUF9USEVNRVMgPSBbCiAge25hbWU6J0lORFVTVFJJQUwnLGZsb29yOicjMDUwYTBhJyxncmlkOidyZ2JhKDI1NSwxNDAsMCwuMDMpJywgd2Y6JyMwYTBlMTInLHdzOidyZ2JhKDI1NSwxNDAsNTAsLjI4KScsd2E6J3JnYmEoMjU1LDE0MCw1MCwuNzUpJyxzdDoncmdiYSgyNTUsMTAwLDAsLjA3KSd9LAogIHtuYW1lOidSVUlOUycsICAgICBmbG9vcjonIzA4MDcxMCcsZ3JpZDoncmdiYSgxODAsMTUwLDcwLC4wMyknLHdmOicjMGYwYTA2Jyx3czoncmdiYSgxOTAsMTQwLDYwLC4zKScsIHdhOidyZ2JhKDIxMCwxNzAsODAsLjc1KScsc3Q6J3JnYmEoMTYwLDExMCw0MCwuMDcpJ30sCiAge25hbWU6J0JVTktFUicsICAgIGZsb29yOicjMDQwODEwJyxncmlkOidyZ2JhKDAsMjEwLDkwLC4wMyknLCAgd2Y6JyMwNDBhMDYnLHdzOidyZ2JhKDAsMTgwLDgwLC4yNyknLCAgd2E6J3JnYmEoMCwyMjAsMTAwLC43NSknLCBzdDoncmdiYSgwLDE3MCw3MCwuMDcpJ30sCiAge25hbWU6J1ZPSUQnLCAgICAgIGZsb29yOicjMDUwNDA4JyxncmlkOidyZ2JhKDE2MCwwLDI1NSwuMDMpJywgd2Y6JyMwYTA1MTAnLHdzOidyZ2JhKDE0MCwwLDIzMCwuMyknLCAgd2E6J3JnYmEoMTcwLDAsMjU1LC43NSknLCBzdDoncmdiYSgxMzAsMCwyMTAsLjA3KSd9LAogIHtuYW1lOidORU9OJywgICAgICBmbG9vcjonIzA2MDQwOCcsZ3JpZDoncmdiYSgyNTUsMCwxMzAsLjAzKScsIHdmOicjMGQwNDEwJyx3czoncmdiYSgyNTUsMCwxMDAsLjI3KScsIHdhOidyZ2JhKDI1NSwwLDEzMCwuNzUpJywgc3Q6J3JnYmEoMjEwLDAsOTUsLjA3KSd9LApdOwoKLy8g4pSA4pSAIE1BUCBHRU5FUkFUT1JTIOKUgOKUgApjb25zdCBBVz0xNDAwLEFIPTgwMCxTUEFXTl9DPTIxMDsKZnVuY3Rpb24gZ2VuU3ltbWV0cmljKCl7cmV0dXJuW3t4OjY0NSx5OjM0NSx3OjExMCxoOjExMH0se3g6Mjk1LHk6MTQwLHc6ODUsaDoxNzB9LHt4OjI5NSx5OjQ5MCx3Ojg1LGg6MTcwfSx7eDpBVy0zODAseToxNDAsdzo4NSxoOjE3MH0se3g6QVctMzgwLHk6NDkwLHc6ODUsaDoxNzB9LHt4OjQ5MCx5OjY1LHc6MTMwLGg6NjV9LHt4OjQ5MCx5OkFILTEzMCx3OjEzMCxoOjY1fSx7eDpBVy02MjAseTo2NSx3OjEzMCxoOjY1fSx7eDpBVy02MjAseTpBSC0xMzAsdzoxMzAsaDo2NX1dO30KZnVuY3Rpb24gZ2VuQ29ycmlkb3JzKCl7cmV0dXJuW3t4OjIyNSx5OjI0NSx3OjM1MCxoOjQwfSx7eDo4MjUseToyNDUsdzozNTAsaDo0MH0se3g6MjI1LHk6QUgtMjg1LHc6MzUwLGg6NDB9LHt4OjgyNSx5OkFILTI4NSx3OjM1MCxoOjQwfSx7eDpBVy8yLTM1LHk6MTUwLHc6NzAsaDoxNjV9LHt4OkFXLzItMzUseTpBSC0zMTUsdzo3MCxoOjE2NX0se3g6QVcvMi0zNSx5OkFILzItMzUsdzo3MCxoOjcwfV07fQpmdW5jdGlvbiBnZW5Gb3J0cmVzcygpe3JldHVyblt7eDozODUseToxODUsdzo3NSxoOjE5NX0se3g6Mzg1LHk6MTg1LHc6MTk1LGg6NzV9LHt4OjM4NSx5OkFILTM4MCx3Ojc1LGg6MTk1fSx7eDozODUseTpBSC0yNjAsdzoxOTUsaDo3NX0se3g6QVctNDYwLHk6MTg1LHc6NzUsaDoxOTV9LHt4OkFXLTU4MCx5OjE4NSx3OjE5NSxoOjc1fSx7eDpBVy00NjAseTpBSC0zODAsdzo3NSxoOjE5NX0se3g6QVctNTgwLHk6QUgtMjYwLHc6MTk1LGg6NzV9LHt4OkFXLzItNDUseTpBSC8yLTkwLHc6OTAsaDoxODB9XTt9CmZ1bmN0aW9uIGdlbk9wZW4oKXtyZXR1cm5be3g6QVcvMi01NSx5OkFILzItNTUsdzoxMTAsaDoxMTB9LHt4OjMzMCx5OjE4MCx3Ojc1LGg6NzV9LHt4OjMzMCx5OkFILTI1NSx3Ojc1LGg6NzV9LHt4OkFXLTQwNSx5OjE4MCx3Ojc1LGg6NzV9LHt4OkFXLTQwNSx5OkFILTI1NSx3Ojc1LGg6NzV9LHt4OjU0MCx5OkFILzItMzgsdzo5NSxoOjc2fSx7eDpBVy02MzUseTpBSC8yLTM4LHc6OTUsaDo3Nn1dO30KZnVuY3Rpb24gZ2VuTWF6ZSgpe3JldHVyblt7eDozMTAseTowLHc6NjAsaDoyODB9LHt4OjMxMCx5OjQwMCx3OjYwLGg6NDAwfSx7eDpBVy0zNzAseTowLHc6NjAsaDoyODB9LHt4OkFXLTM3MCx5OjQwMCx3OjYwLGg6NDAwfSx7eDo1NjAseToxNjAsdzo2MCxoOjI4MH0se3g6NTYwLHk6NTYwLHc6NjAsaDoyNDB9LHt4OkFXLTYyMCx5OjE2MCx3OjYwLGg6MjgwfSx7eDpBVy02MjAseTo1NjAsdzo2MCxoOjI0MH0se3g6QVcvMi0zNSx5OjAsdzo3MCxoOjE2MH0se3g6QVcvMi0zNSx5OjY0MCx3OjcwLGg6MTYwfV07fQpmdW5jdGlvbiBnZW4xdjEoKXtyZXR1cm5bCiAge3g6QVcvMi01NSx5OkFILzItNTUsdzoxMTAsaDoxMTB9LAogIHt4OkFXLzItMTYwLHk6QUgvMi0xNjAsdzo1NSxoOjU1fSx7eDpBVy8yKzEwNSx5OkFILzItMTYwLHc6NTUsaDo1NX0sCiAge3g6QVcvMi0xNjAseTpBSC8yKzEwNSx3OjU1LGg6NTV9LHt4OkFXLzIrMTA1LHk6QUgvMisxMDUsdzo1NSxoOjU1fSwKICB7eDpBVy8yLTI1MCx5OkFILzItMjUsdzo3MCxoOjUwfSx7eDpBVy8yKzE4MCx5OkFILzItMjUsdzo3MCxoOjUwfSwKICB7eDpBVy8yLTI1LHk6QUgvMi0yMjAsdzo1MCxoOjcwfSx7eDpBVy8yLTI1LHk6QUgvMisxNTAsdzo1MCxoOjcwfSwKXTt9Owpjb25zdCBHRU5fRk5TPVtnZW5TeW1tZXRyaWMsZ2VuQ29ycmlkb3JzLGdlbkZvcnRyZXNzLGdlbk9wZW4sZ2VuTWF6ZV07CgpmdW5jdGlvbiBnZW5lcmF0ZU1hcCgpewogIGNvbnN0IHRoZW1lPU1BUF9USEVNRVNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKk1BUF9USEVNRVMubGVuZ3RoKV07CiAgY29uc3Qgb2JzdGFjbGVzPWNob3Nlbk1vZGUmJmNob3Nlbk1vZGUuaWQ9PT0nMXYxJz9nZW4xdjEoKTpHRU5fRk5TW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSpHRU5fRk5TLmxlbmd0aCldKCk7CiAgcmV0dXJuIHt0aGVtZSxvYnN0YWNsZXN9Owp9CgovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKLy8gIEdBTUUgU1RBVEUKLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCmxldCBjYW52YXMsY3R4LGN1cnJlbnRNYXA7CmxldCBlbnRpdGllcz1bXSxidWxsZXRzPVtdLHBhcnRpY2xlcz1bXSxwb3dlcnVwcz1bXTsKbGV0IGZsYWdzPXtyZWQ6bnVsbCxibHVlOm51bGx9OwpsZXQga290aFNjb3JlPXtyZWQ6MCxibHVlOjB9LGN0ZkNhcHM9e3JlZDowLGJsdWU6MH07CmxldCBmZmFTY29yZT17fTsKbGV0IGtpbGxzPXtyZWQ6MCxibHVlOjB9OwpsZXQgZmVlZEl0ZW1zPVtdOwpsZXQgcGxheWVyPW51bGw7CmxldCBjaG9zZW5UZWFtPW51bGwsY2hvc2VuU2tpbj1udWxsLGNob3Nlbkd1bj1udWxsLGNob3Nlbk1vZGU9bnVsbDsKbGV0IHBsYXllck5hbWU9J1BMQVlFUic7CmxldCBydW5uaW5nPWZhbHNlLGxhc3RUcz0wOwpsZXQga2V5cz17fSxtb3VzZT17eDpBVy8yLHk6QUgvMn0sbW91c2Vkb3duPWZhbHNlOwpsZXQgc2hha2VYPTAsc2hha2VZPTAsc2hha2VNYWc9MDsKbGV0IHNjbD0xLG94PTAsb3k9MDsKbGV0IHBvd3VwVGltZXI9MCxwb3d1cEludGVydmFsPTg7CgovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKLy8gIFBPV0VSVVAKLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCmNsYXNzIFBvd2VydXAgewogIGNvbnN0cnVjdG9yKHgseSx0eXBlKXsKICAgIHRoaXMueD14O3RoaXMueT15O3RoaXMudHlwZT10eXBlOwogICAgdGhpcy5hbmltPU1hdGgucmFuZG9tKCkqTWF0aC5QSSoyOwogICAgdGhpcy5kZWFkPWZhbHNlOwogIH0KICBkcmF3KCl7CiAgICBjb25zdCB0PWN1cnJlbnRNYXAudGhlbWUsYz1jdHg7CiAgICBjb25zdCBib2I9TWF0aC5zaW4oRGF0ZS5ub3coKSouMDAyK3RoaXMuYW5pbSkqNDsKICAgIGMuc2F2ZSgpO2MudHJhbnNsYXRlKHRoaXMueCx0aGlzLnkrYm9iKTsKICAgIGMuc2hhZG93Q29sb3I9dGhpcy50eXBlLmNvbDtjLnNoYWRvd0JsdXI9MTQ7CiAgICBjLmJlZ2luUGF0aCgpO2MuYXJjKDAsMCwxMSwwLE1hdGguUEkqMik7CiAgICBjLmZpbGxTdHlsZT0ncmdiYSg1LDUsOCwuOSknO2MuZmlsbCgpOwogICAgYy5zdHJva2VTdHlsZT10aGlzLnR5cGUuY29sO2MubGluZVdpZHRoPTI7Yy5zdHJva2UoKTsKICAgIGMuc2hhZG93Qmx1cj0wOwogICAgYy5mb250PScxMnB4IHNhbnMtc2VyaWYnO2MudGV4dEFsaWduPSdjZW50ZXInO2MudGV4dEJhc2VsaW5lPSdtaWRkbGUnOwogICAgYy5maWxsVGV4dCh0aGlzLnR5cGUuaWNvbiwwLDApOwogICAgYy5yZXN0b3JlKCk7CiAgfQp9CgovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKLy8gIEJVTExFVAovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKY2xhc3MgQnVsbGV0IHsKICBjb25zdHJ1Y3Rvcih4LHksYW5nbGUsc2hvb3RlcixnZCl7CiAgICB0aGlzLng9eDt0aGlzLnk9eTt0aGlzLnB4PXg7dGhpcy5weT15OwogICAgdGhpcy5zaG9vdGVyPXNob290ZXI7dGhpcy50ZWFtPXNob290ZXIudGVhbTsKICAgIHRoaXMuZG1nPWdkLmRtZyooc2hvb3Rlci5wb3dEYW1hZ2U/MjoxKTsKICAgIHRoaXMuZ3VuSWQ9Z2QuaWQ7dGhpcy5zcGQ9Z2Quc3BkOwogICAgdGhpcy52eD1NYXRoLmNvcyhhbmdsZSkqdGhpcy5zcGQ7dGhpcy52eT1NYXRoLnNpbihhbmdsZSkqdGhpcy5zcGQ7CiAgICB0aGlzLmxpZmU9Z2QucmFuZ2U7dGhpcy5jb2w9Z2QuY29sO3RoaXMudHc9Z2QudHc7dGhpcy5kZWFkPWZhbHNlOwogIH0KICB1cGRhdGUoZHQpewogICAgdGhpcy5weD10aGlzLng7dGhpcy5weT10aGlzLnk7CiAgICB0aGlzLngrPXRoaXMudngqZHQ7dGhpcy55Kz10aGlzLnZ5KmR0OwogICAgdGhpcy5saWZlLT1kdDsKICAgIGlmKHRoaXMubGlmZTw9MHx8dGhpcy54PC0xMHx8dGhpcy54PkFXKzEwfHx0aGlzLnk8LTEwfHx0aGlzLnk+QUgrMTApe3RoaXMuZGVhZD10cnVlO3JldHVybjt9CiAgICBmb3IoY29uc3Qgb2Igb2YgY3VycmVudE1hcC5vYnN0YWNsZXMpewogICAgICBpZih0aGlzLng+b2IueCYmdGhpcy54PG9iLngrb2IudyYmdGhpcy55Pm9iLnkmJnRoaXMueTxvYi55K29iLmgpe3RoaXMuZGVhZD10cnVlO3NwYXduQnVyc3QodGhpcy54LHRoaXMueSx0aGlzLmNvbCw0KTtyZXR1cm47fQogICAgfQogICAgZm9yKGNvbnN0IGUgb2YgZW50aXRpZXMpewogICAgICBpZihlPT09dGhpcy5zaG9vdGVyfHwoY2hvc2VuTW9kZSYmY2hvc2VuTW9kZS50ZWFtcyYmZS50ZWFtPT09dGhpcy50ZWFtKXx8ZS5kZWFkKSBjb250aW51ZTsKICAgICAgaWYoTWF0aC5oeXBvdChlLngtdGhpcy54LGUueS10aGlzLnkpPDE1KXsKICAgICAgICBlLnRha2VEYW1hZ2UodGhpcy5zaG9vdGVyLHRoaXMuZG1nKTsKICAgICAgICB0aGlzLmRlYWQ9dHJ1ZTtzcGF3bkJ1cnN0KHRoaXMueCx0aGlzLnksdGhpcy5jb2wsMTApOwogICAgICAgIHNoYWtlKHRoaXMuZ3VuSWQ9PT0nc25pcGVyJz85OnRoaXMuZ3VuSWQ9PT0nc2hvdGd1bic/NzozKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KICB9CiAgZHJhdygpewogICAgY29uc3QgYT1NYXRoLm1pbigxLHRoaXMubGlmZSozKTsKICAgIGN0eC5zYXZlKCk7Y3R4Lmdsb2JhbEFscGhhPWEqLjg7CiAgICBjdHguc3Ryb2tlU3R5bGU9dGhpcy5jb2w7Y3R4LmxpbmVXaWR0aD10aGlzLnR3OwogICAgY3R4LnNoYWRvd0NvbG9yPXRoaXMuY29sO2N0eC5zaGFkb3dCbHVyPXRoaXMuZ3VuSWQ9PT0nc25pcGVyJz8xMjo1OwogICAgY3R4LmJlZ2luUGF0aCgpO2N0eC5tb3ZlVG8odGhpcy5weCx0aGlzLnB5KTtjdHgubGluZVRvKHRoaXMueCx0aGlzLnkpO2N0eC5zdHJva2UoKTsKICAgIGN0eC5zaGFkb3dCbHVyPTE0O2N0eC5maWxsU3R5bGU9JyNmZmYnOwogICAgY3R4LmJlZ2luUGF0aCgpO2N0eC5hcmModGhpcy54LHRoaXMueSx0aGlzLnR3LDAsTWF0aC5QSSoyKTtjdHguZmlsbCgpOwogICAgY3R4LnJlc3RvcmUoKTsKICB9Cn0KCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAovLyAgUEFSVElDTEUKLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCmNsYXNzIFBhcnRpY2xlIHsKICBjb25zdHJ1Y3Rvcih4LHksY29sLGJpZyl7CiAgICB0aGlzLng9eDt0aGlzLnk9eTt0aGlzLmNvbD1jb2w7CiAgICBjb25zdCBhPU1hdGgucmFuZG9tKCkqTWF0aC5QSSoyLHM9YmlnPzExMCtNYXRoLnJhbmRvbSgpKjI5MDo1MCtNYXRoLnJhbmRvbSgpKjE4MDsKICAgIHRoaXMudng9TWF0aC5jb3MoYSkqczt0aGlzLnZ5PU1hdGguc2luKGEpKnM7CiAgICB0aGlzLmxpZmU9YmlnPy40K01hdGgucmFuZG9tKCkqLjU6LjIrTWF0aC5yYW5kb20oKSouMzsKICAgIHRoaXMubWw9dGhpcy5saWZlO3RoaXMucj1iaWc/MitNYXRoLnJhbmRvbSgpKjU6MS41K01hdGgucmFuZG9tKCkqMzsKICB9CiAgdXBkYXRlKGR0KXt0aGlzLngrPXRoaXMudngqZHQ7dGhpcy55Kz10aGlzLnZ5KmR0O3RoaXMudngqPS44Nzt0aGlzLnZ5Kj0uODc7dGhpcy5saWZlLT1kdDt9CiAgZHJhdygpe2NvbnN0IGE9TWF0aC5tYXgoMCx0aGlzLmxpZmUvdGhpcy5tbCk7Y3R4Lmdsb2JhbEFscGhhPWE7Y3R4LmJlZ2luUGF0aCgpO2N0eC5hcmModGhpcy54LHRoaXMueSx0aGlzLnIqTWF0aC5zcXJ0KGEpLDAsTWF0aC5QSSoyKTtjdHguZmlsbFN0eWxlPXRoaXMuY29sO2N0eC5maWxsKCk7Y3R4Lmdsb2JhbEFscGhhPTE7fQp9CmZ1bmN0aW9uIHNwYXduQnVyc3QoeCx5LGNvbCxuLGJpZz1mYWxzZSl7Zm9yKGxldCBpPTA7aTxuO2krKylwYXJ0aWNsZXMucHVzaChuZXcgUGFydGljbGUoeCx5LGNvbCxiaWcpKTt9CgovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKLy8gIEVOVElUWQovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKY29uc3QgUkFEPTE1LE1BWF9IUD0zLFNXT1JEX1I9NjgsU1dPUkRfQVJDPU1hdGguUEkqLjY4LEFUS19EVVI9LjI1LFNXT1JEX0NEPTAuOTsKY29uc3QgUF9TUEVFRD0yNTAsQl9TUEVFRD0xNTUsUkVTUEFXTl9TPTM7CgpjbGFzcyBFbnRpdHkgewogIGNvbnN0cnVjdG9yKHgseSx0ZWFtLG5hbWUsaXNQbGF5ZXIsc2tpbklkLGd1bklkKXsKICAgIHRoaXMueD14O3RoaXMueT15O3RoaXMudGVhbT10ZWFtO3RoaXMubmFtZT1uYW1lO3RoaXMuaXNQbGF5ZXI9ISFpc1BsYXllcjsKICAgIHRoaXMuc2tpbj1TS0lOUy5maW5kKHM9PnMuaWQ9PT1za2luSWQpfHxTS0lOU1swXTsKICAgIHRoaXMuc2V0R3VuKGd1bklkfHwncGlzdG9sJyk7CiAgICB0aGlzLmhwPU1BWF9IUDt0aGlzLmRlYWQ9ZmFsc2U7CiAgICB0aGlzLmFuZ2xlPXRlYW09PT0ncmVkJz8uMTpNYXRoLlBJLS4xOwogICAgdGhpcy52eD0wO3RoaXMudnk9MDsKICAgIHRoaXMuc3BlZWQ9aXNQbGF5ZXI/UF9TUEVFRDpCX1NQRUVEOwogICAgdGhpcy5raWxscz0wO3RoaXMuZGVhdGhzPTA7dGhpcy5zY29yZT0wOwogICAgdGhpcy5oaXRGbGFzaD0wO3RoaXMuc3RyZWFrPTA7CiAgICAvLyBQb3dlcnVwIGJ1ZmZzCiAgICB0aGlzLnBvd1NwZWVkPWZhbHNlO3RoaXMucG93U3BlZWRUaW1lcj0wOwogICAgdGhpcy5wb3dEYW1hZ2U9ZmFsc2U7dGhpcy5wb3dEYW1hZ2VUaW1lcj0wOwogICAgdGhpcy5zaGllbGQ9MDsKICAgIC8vIE1lbGVlCiAgICB0aGlzLmF0dGFja2luZz1mYWxzZTt0aGlzLmF0a0FuZ2xlPTA7dGhpcy5hdGtUaW1lcj0wO3RoaXMuYXRrQ0Q9MDt0aGlzLmhpdFRhcmdldHM9bmV3IFNldCgpO3RoaXMuc3dvcmRIaXRzPTA7CiAgICAvLyBHdW4gZ2FtZQogICAgdGhpcy5ndW5JbmRleD0wOwogICAgLy8gQ1RGCiAgICB0aGlzLmhhc0ZsYWc9bnVsbDsKICAgIC8vIEJvdAogICAgdGhpcy50YXJnZXQ9bnVsbDt0aGlzLndhbmRlckFuZ2xlPU1hdGgucmFuZG9tKCkqTWF0aC5QSSoyO3RoaXMud2FuZGVyVGltZXI9MDsKICAgIHRoaXMuYWdncm89LjQrTWF0aC5yYW5kb20oKSouNjt0aGlzLnJlc3Bhd25UaW1lcj0wO3RoaXMuYm90R3VuQ0Q9MDsKICAgIHRoaXMuc3RhdGVUaW1lcj0wO3RoaXMuc3RhdGU9J2NoYXNlJzsKICB9CiAgc2V0R3VuKGlkKXsKICAgIHRoaXMuZ3VuPUdVTlMuZmluZChnPT5nLmlkPT09aWQpfHxHVU5TWzBdOwogICAgdGhpcy5hbW1vPXRoaXMuZ3VuLm1heEFtbW87dGhpcy5yZWxvYWRpbmc9ZmFsc2U7dGhpcy5yZWxvYWRUaW1lcj0wO3RoaXMuZmlyZUNvb2xkb3duPTA7CiAgfQogIGdldCB0ZWFtQ29sKCl7cmV0dXJuIHRoaXMudGVhbT09PSdyZWQnPycjRkYzMTMxJzp0aGlzLnRlYW09PT0nYmx1ZSc/JyMxRTkwRkYnOicjRkZFNjAwJzt9CiAgZ2V0IHRlYW1HbG93KCl7cmV0dXJuIHRoaXMudGVhbT09PSdyZWQnPydyZ2JhKDI1NSw0OSw0OSwuNTUpJzp0aGlzLnRlYW09PT0nYmx1ZSc/J3JnYmEoMzAsMTQ0LDI1NSwuNTUpJzoncmdiYSgyNTUsMjMwLDAsLjU1KSc7fQogIAogIHJlc3Bhd24oKXsKICAgIGxldCB4LHksc2FmZT1mYWxzZSx0PTA7CiAgICB3aGlsZSghc2FmZSYmdDw0MCl7CiAgICAgIGlmKGNob3Nlbk1vZGUuaWQ9PT0nMXYxJyl7CiAgICAgICAgeD1BVy8yKyhNYXRoLnJhbmRvbSgpLS41KSozMDA7CiAgICAgIH0gZWxzZSBpZihjaG9zZW5Nb2RlLnRlYW1zKXsKICAgICAgICB4PXRoaXMudGVhbT09PSdyZWQnPzU1K01hdGgucmFuZG9tKCkqMTMwOkFXLTU1LU1hdGgucmFuZG9tKCkqMTMwOwogICAgICB9IGVsc2UgewogICAgICAgIHg9TWF0aC5yYW5kb20oKTwuNT81NStNYXRoLnJhbmRvbSgpKjEzMDpBVy01NS1NYXRoLnJhbmRvbSgpKjEzMDsKICAgICAgfQogICAgICB5PTgwK01hdGgucmFuZG9tKCkqKEFILTE2MCk7CiAgICAgIHNhZmU9dHJ1ZTsKICAgICAgZm9yKGNvbnN0IG9iIG9mIGN1cnJlbnRNYXAub2JzdGFjbGVzKWlmKHg+b2IueC1SQUQmJng8b2IueCtvYi53K1JBRCYmeT5vYi55LVJBRCYmeTxvYi55K29iLmgrUkFEKXtzYWZlPWZhbHNlO2JyZWFrO30KICAgICAgdCsrOwogICAgfQogICAgdGhpcy54PXg7dGhpcy55PXk7CiAgICB0aGlzLmhwPU1BWF9IUDt0aGlzLmRlYWQ9ZmFsc2U7dGhpcy5oaXRGbGFzaD0wO3RoaXMuc3dvcmRIaXRzPTA7CiAgICB0aGlzLmFtbW89dGhpcy5ndW4ubWF4QW1tbzt0aGlzLnJlbG9hZGluZz1mYWxzZTt0aGlzLnJlbG9hZFRpbWVyPTA7CiAgICB0aGlzLmZpcmVDb29sZG93bj0wO3RoaXMuYXRrQ0Q9MDt0aGlzLmhpdFRhcmdldHMuY2xlYXIoKTsKICAgIHRoaXMucmVzcGF3blRpbWVyPTA7dGhpcy5zaGllbGQ9MDsKICAgIGlmKHRoaXMuaGFzRmxhZyl7dGhpcy5oYXNGbGFnLmNhcnJpZXI9bnVsbDt0aGlzLmhhc0ZsYWcuZHJvcHBlZD10cnVlO3RoaXMuaGFzRmxhZz1udWxsO30KICAgIGlmKHRoaXMuaXNQbGF5ZXIpe3RoaXMucG93U3BlZWQ9ZmFsc2U7dGhpcy5wb3dEYW1hZ2U9ZmFsc2U7fQogIH0KCiAgdGFrZURhbWFnZShhdHRhY2tlcixkbWc9MSl7CiAgICBpZih0aGlzLmRlYWQpcmV0dXJuOwogICAgaWYodGhpcy5zaGllbGQ+MCl7dGhpcy5zaGllbGQ9TWF0aC5tYXgoMCx0aGlzLnNoaWVsZC1kbWcpO3RoaXMuaGl0Rmxhc2g9LjE1O3NwYXduQnVyc3QodGhpcy54LHRoaXMueSwnIzAwRjVGRicsNik7aWYodGhpcy5pc1BsYXllcil1cGRIcEh1ZCgpO3JldHVybjt9CiAgICB0aGlzLmhwPU1hdGgubWF4KDAsdGhpcy5ocC1kbWcpO3RoaXMuaGl0Rmxhc2g9LjI7CiAgICBpZih0aGlzLmhwPD0wKXRoaXMuZGllKGF0dGFja2VyKTsKICAgIGVsc2UgaWYodGhpcy5pc1BsYXllcil1cGRIcEh1ZCgpOwogIH0KCiAgZGllKGF0dGFja2VyKXsKICAgIHRoaXMuZGVhZD10cnVlO3RoaXMuaHA9MDt0aGlzLmRlYXRocysrO3RoaXMuc3RyZWFrPTA7CiAgICB0aGlzLnJlc3Bhd25UaW1lcj1SRVNQQVdOX1M7CiAgICBzcGF3bkJ1cnN0KHRoaXMueCx0aGlzLnksdGhpcy50ZWFtQ29sLDI4LHRydWUpOwogICAgc3Bhd25CdXJzdCh0aGlzLngsdGhpcy55LCcjRkZFNjAwJyw4LHRydWUpOwogICAgaWYodGhpcy5oYXNGbGFnKXsKICAgICAgY29uc3QgZj10aGlzLmhhc0ZsYWc7Zi5jYXJyaWVyPW51bGw7Zi5kZWFkPWZhbHNlOwogICAgICBmLmRyb3BwZWQ9dHJ1ZTtmLng9dGhpcy54O2YueT10aGlzLnk7Zi5kcm9wVGltZXI9ODsKICAgICAgdGhpcy5oYXNGbGFnPW51bGw7CiAgICB9CiAgICBpZihhdHRhY2tlcil7CiAgICAgIGF0dGFja2VyLmtpbGxzKys7YXR0YWNrZXIuc3RyZWFrKys7CiAgICAgIGlmKGNob3Nlbk1vZGUudGVhbXMpa2lsbHNbYXR0YWNrZXIudGVhbV0rKzsKICAgICAgZWxzZSBmZmFTY29yZVthdHRhY2tlci5uYW1lXT0oZmZhU2NvcmVbYXR0YWNrZXIubmFtZV18fDApKzE7CiAgICAgIGF0dGFja2VyLnNjb3JlKz0xMDA7CiAgICAgIGFkZEZlZWQoYXR0YWNrZXIubmFtZSx0aGlzLm5hbWUsYXR0YWNrZXIudGVhbXx8J2ZmYScpOwogICAgICBpZihhdHRhY2tlci5pc1BsYXllcnx8dGhpcy5pc1BsYXllcil1cGRTdGF0c0h1ZCgpOwogICAgICBpZihhdHRhY2tlci5pc1BsYXllciYmU1RSRUFLX05BTUVTW2F0dGFja2VyLnN0cmVha10pc2hvd1N0cmVhayhTVFJFQUtfTkFNRVNbYXR0YWNrZXIuc3RyZWFrXSk7CiAgICAgIC8vIEd1biBnYW1lOiBhZHZhbmNlIHdlYXBvbgogICAgICBpZihjaG9zZW5Nb2RlLmlkPT09J2d1bicpewogICAgICAgIGNvbnN0IG5pPU1hdGgubWluKEdVTl9PUkRFUi5sZW5ndGgtMSxHVU5fT1JERVIuaW5kZXhPZihhdHRhY2tlci5ndW4uaWQpKzEpOwogICAgICAgIGF0dGFja2VyLnNldEd1bihHVU5fT1JERVJbbmldKTsKICAgICAgICBpZihhdHRhY2tlci5pc1BsYXllcil7dXBkQW1tb0h1ZCgpO3VwZEd1bkdhbWVIdWQoKTt9CiAgICAgICAgaWYobmk9PT1HVU5fT1JERVIubGVuZ3RoLTEmJmF0dGFja2VyLmtpbGxzPj0xKWNoZWNrV2luKCk7CiAgICAgIH0KICAgICAgY2hlY2tXaW4oKTsKICAgIH0KICAgIHNoYWtlKHRoaXMuaXNQbGF5ZXI/MTA6NCk7CiAgfQoKICByZWxvYWQoKXtpZih0aGlzLnJlbG9hZGluZ3x8dGhpcy5hbW1vPT09dGhpcy5ndW4ubWF4QW1tbylyZXR1cm47dGhpcy5yZWxvYWRpbmc9dHJ1ZTt0aGlzLnJlbG9hZFRpbWVyPXRoaXMuZ3VuLnJlbG9hZDt9CiAgCiAgc2hvb3QoYW5nbGUpewogICAgaWYodGhpcy5maXJlQ29vbGRvd24+MHx8dGhpcy5yZWxvYWRpbmd8fHRoaXMuYW1tbzw9MHx8dGhpcy5kZWFkKXJldHVybjsKICAgIGZvcihsZXQgaT0wO2k8dGhpcy5ndW4ucGVsbGV0cztpKyspewogICAgICBjb25zdCBzcHJlYWQ9KE1hdGgucmFuZG9tKCktLjUpKnRoaXMuZ3VuLnNwcmVhZCoyKyh0aGlzLmd1bi5wZWxsZXRzPjE/KGktMikqLjA2OjApOwogICAgICBidWxsZXRzLnB1c2gobmV3IEJ1bGxldCh0aGlzLngsdGhpcy55LGFuZ2xlK3NwcmVhZCx0aGlzLHRoaXMuZ3VuKSk7CiAgICB9CiAgICB0aGlzLmFtbW8tLTt0aGlzLmZpcmVDb29sZG93bj10aGlzLmd1bi5yYXRlOwogICAgaWYodGhpcy5hbW1vPT09MCl0aGlzLnJlbG9hZCgpOwogICAgaWYodGhpcy5pc1BsYXllcil7dXBkQW1tb0h1ZCgpO3NoYWtlKHRoaXMuZ3VuLmlkPT09J3Nob3RndW4nPzU6dGhpcy5ndW4uaWQ9PT0nc25pcGVyJz80OjEpO30KICB9CgogIHN0YXJ0TWVsZWUoKXtpZih0aGlzLmF0a0NEPjB8fHRoaXMuYXR0YWNraW5nfHx0aGlzLmRlYWQpcmV0dXJuO3RoaXMuYXR0YWNraW5nPXRydWU7dGhpcy5hdGtBbmdsZT10aGlzLmFuZ2xlO3RoaXMuYXRrVGltZXI9QVRLX0RVUjt0aGlzLmF0a0NEPVNXT1JEX0NEO3RoaXMuaGl0VGFyZ2V0cy5jbGVhcigpO30KICAKICBjaGVja01lbGVlSGl0KCl7CiAgICBmb3IoY29uc3QgZSBvZiBlbnRpdGllcyl7CiAgICAgIGlmKGU9PT10aGlzfHwoY2hvc2VuTW9kZSYmY2hvc2VuTW9kZS50ZWFtcyYmZS50ZWFtPT09dGhpcy50ZWFtKXx8ZS5kZWFkfHx0aGlzLmhpdFRhcmdldHMuaGFzKGUpKWNvbnRpbnVlOwogICAgICBjb25zdCBkeD1lLngtdGhpcy54LGR5PWUueS10aGlzLnksZD1NYXRoLmh5cG90KGR4LGR5KTsKICAgICAgaWYoZD5TV09SRF9SK1JBRCljb250aW51ZTsKICAgICAgbGV0IGRpZmY9TWF0aC5hdGFuMihkeSxkeCktdGhpcy5hdGtBbmdsZTsKICAgICAgd2hpbGUoZGlmZj5NYXRoLlBJKWRpZmYtPU1hdGguUEkqMjt3aGlsZShkaWZmPC1NYXRoLlBJKWRpZmYrPU1hdGguUEkqMjsKICAgICAgaWYoTWF0aC5hYnMoZGlmZik8PVNXT1JEX0FSQyl7dGhpcy5oaXRUYXJnZXRzLmFkZChlKTtzcGF3bkJ1cnN0KGUueCxlLnksInJnYmEoMjU1LDIyMCw1MCwuNykiLDQpO2lmKGUuc2hpZWxkPjApe2Uuc2hpZWxkPU1hdGgubWF4KDAsZS5zaGllbGQtMSk7ZS5oaXRGbGFzaD0uMTg7c3Bhd25CdXJzdChlLngsZS55LCIjMDBGNUZGIiw2KTtpZihlLmlzUGxheWVyKXVwZEhwSHVkKCk7fWVsc2V7ZS5zd29yZEhpdHM9KGUuc3dvcmRIaXRzfHwwKSsxO2UuaGl0Rmxhc2g9LjI7aWYoZS5zd29yZEhpdHM+PTIpe2Uuc3dvcmRIaXRzPTA7ZS50YWtlRGFtYWdlKHRoaXMsMSk7fWVsc2V7c2hha2UoMyk7aWYoZS5pc1BsYXllcil1cGRIcEh1ZCgpO319fQogICAgfQogIH0KCiAgdXBkYXRlUG93ZXJ1cHMoZHQpewogICAgaWYodGhpcy5wb3dTcGVlZCl7dGhpcy5wb3dTcGVlZFRpbWVyLT1kdDtpZih0aGlzLnBvd1NwZWVkVGltZXI8PTApe3RoaXMucG93U3BlZWQ9ZmFsc2U7dGhpcy5zcGVlZD10aGlzLmlzUGxheWVyP1BfU1BFRUQ6Ql9TUEVFRDt9fQogICAgaWYodGhpcy5wb3dEYW1hZ2Upe3RoaXMucG93RGFtYWdlVGltZXItPWR0O2lmKHRoaXMucG93RGFtYWdlVGltZXI8PTApdGhpcy5wb3dEYW1hZ2U9ZmFsc2U7fQogIH0KCiAgdXBkYXRlKGR0KXsKICAgIHRoaXMudXBkYXRlUG93ZXJ1cHMoZHQpOwogICAgaWYodGhpcy5oaXRGbGFzaD4wKXRoaXMuaGl0Rmxhc2g9TWF0aC5tYXgoMCx0aGlzLmhpdEZsYXNoLWR0KTsKICAgIGlmKHRoaXMuZmlyZUNvb2xkb3duPjApdGhpcy5maXJlQ29vbGRvd24tPWR0OwogICAgaWYodGhpcy5hdGtDRD4wKXRoaXMuYXRrQ0QtPWR0OwogICAgaWYodGhpcy5yZWxvYWRpbmcpe3RoaXMucmVsb2FkVGltZXItPWR0O2lmKHRoaXMucmVsb2FkVGltZXI8PTApe3RoaXMucmVsb2FkaW5nPWZhbHNlO3RoaXMuYW1tbz10aGlzLmd1bi5tYXhBbW1vO2lmKHRoaXMuaXNQbGF5ZXIpdXBkQW1tb0h1ZCgpO319CiAgICBpZih0aGlzLmF0dGFja2luZyl7dGhpcy5hdGtUaW1lci09ZHQ7aWYodGhpcy5hdGtUaW1lcjw9MCl0aGlzLmF0dGFja2luZz1mYWxzZTtlbHNlIHRoaXMuY2hlY2tNZWxlZUhpdCgpO30KICAgIGlmKHRoaXMuZGVhZCl7CiAgICAgIHRoaXMucmVzcGF3blRpbWVyLT1kdDsKICAgICAgaWYodGhpcy5pc1BsYXllcilzZXRSZXNwYXduVUkoTWF0aC5jZWlsKHRoaXMucmVzcGF3blRpbWVyKSk7CiAgICAgIGlmKHRoaXMucmVzcGF3blRpbWVyPD0wKXt0aGlzLnJlc3Bhd24oKTtpZih0aGlzLmlzUGxheWVyKWhpZGVSZXNwYXduVUkoKTt9CiAgICAgIHJldHVybjsKICAgIH0KICAgIHRoaXMuaXNQbGF5ZXI/dGhpcy51cFBsYXllcigpOnRoaXMudXBCb3QoZHQpOwogICAgdGhpcy54Kz10aGlzLnZ4KmR0O3RoaXMueSs9dGhpcy52eSpkdDsKICAgIHRoaXMueD1NYXRoLm1heChSQUQsTWF0aC5taW4oQVctUkFELHRoaXMueCkpOwogICAgdGhpcy55PU1hdGgubWF4KFJBRCxNYXRoLm1pbihBSC1SQUQsdGhpcy55KSk7CiAgICBmb3IoY29uc3Qgb2Igb2YgY3VycmVudE1hcC5vYnN0YWNsZXMpcHVzaE91dCh0aGlzLG9iKTsKICAgIC8vIFBpY2sgdXAgcG93ZXJ1cHMKICAgIGlmKCF0aGlzLmRlYWQpewogICAgICBmb3IoY29uc3QgcCBvZiBwb3dlcnVwcyl7CiAgICAgICAgaWYocC5kZWFkKWNvbnRpbnVlOwogICAgICAgIGlmKE1hdGguaHlwb3QocC54LXRoaXMueCxwLnktdGhpcy55KTwyMCl7CiAgICAgICAgICBwLmRlYWQ9dHJ1ZTsKICAgICAgICAgIGFwcGx5UG93ZXJ1cCh0aGlzLHAudHlwZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvLyBDVEY6IHBpY2sgdXAgZmxhZwogICAgaWYoY2hvc2VuTW9kZS5pZD09PSdjdGYnJiYhdGhpcy5oYXNGbGFnKXsKICAgICAgZm9yKGNvbnN0IHRlYW0gb2ZbJ3JlZCcsJ2JsdWUnXSl7CiAgICAgICAgY29uc3QgZj1mbGFnc1t0ZWFtXTsKICAgICAgICBpZighZnx8Zi5jYXJyaWVyfHxmLmRlYWQpY29udGludWU7CiAgICAgICAgaWYoZi50ZWFtPT09dGhpcy50ZWFtKWNvbnRpbnVlOwogICAgICAgIGlmKE1hdGguaHlwb3QoZi54LXRoaXMueCxmLnktdGhpcy55KTwyMil7CiAgICAgICAgICBmLmNhcnJpZXI9dGhpcztmLmRyb3BwZWQ9ZmFsc2U7dGhpcy5oYXNGbGFnPWY7CiAgICAgICAgICBpZih0aGlzLmlzUGxheWVyKXNob3dQb3dCYW5uZXIoJ/CfmqkgRkxBRyBHUkFCQkVEIScpOwogICAgICAgICAgYWRkRmVlZCh0aGlzLm5hbWUsJ0ZMQUcnLHRoaXMudGVhbSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIC8vIENhcCBmbGFnIGF0IGhvbWUgYmFzZQogICAgICBpZih0aGlzLmhhc0ZsYWcpewogICAgICAgIGNvbnN0IGhvbWVYPXRoaXMudGVhbT09PSdyZWQnP1NQQVdOX0MvMjpBVy1TUEFXTl9DLzI7CiAgICAgICAgaWYoTWF0aC5hYnModGhpcy54LWhvbWVYKTw4MCYmTWF0aC5hYnModGhpcy55LUFILzIpPDE0MCl7CiAgICAgICAgICBjYXBGbGFnKHRoaXMpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgdXBQbGF5ZXIoKXsKICAgIGxldCBkeD0wLGR5PTA7CiAgICBpZihrZXlzWyd3J118fGtleXNbJ2Fycm93dXAnXSlkeS09MTtpZihrZXlzWydzJ118fGtleXNbJ2Fycm93ZG93biddKWR5Kz0xOwogICAgaWYoa2V5c1snYSddfHxrZXlzWydhcnJvd2xlZnQnXSlkeC09MTtpZihrZXlzWydkJ118fGtleXNbJ2Fycm93cmlnaHQnXSlkeCs9MTsKICAgIGNvbnN0IGw9TWF0aC5oeXBvdChkeCxkeSk7aWYobD4wKXtkeC89bDtkeS89bDt9CiAgICBjb25zdCBzcGQ9dGhpcy5zcGVlZCoodGhpcy5wb3dTcGVlZD8xLjU1OjEpOwogICAgdGhpcy52eD1keCpzcGQ7dGhpcy52eT1keSpzcGQ7CiAgICBjb25zdCB3eD0obW91c2UueC1veCkvc2NsLHd5PShtb3VzZS55LW95KS9zY2w7CiAgICB0aGlzLmFuZ2xlPU1hdGguYXRhbjIod3ktdGhpcy55LHd4LXRoaXMueCk7CiAgICAvLyBBdXRvIHNob290IGlmIGhvbGRpbmcgbW91c2UKICAgIGlmKG1vdXNlZG93bil0aGlzLnNob290KHRoaXMuYW5nbGUpOwogIH0KCiAgdXBCb3QoZHQpewogICAgLy8g4pSA4pSAIFRhcmdldCBzZWxlY3Rpb246IGFsd2F5cyBrbm93IHdoZXJlIHRoZSBwbGF5ZXIgaXMg4pSA4pSACiAgICBpZighdGhpcy50YXJnZXR8fHRoaXMudGFyZ2V0LmRlYWQpewogICAgICB0aGlzLnRhcmdldD1udWxsOwogICAgICBjb25zdCBwbGF5ZXJFbnQ9ZW50aXRpZXMuZmluZChlPT5lLmlzUGxheWVyJiYhZS5kZWFkJiYoIWNob3Nlbk1vZGV8fCFjaG9zZW5Nb2RlLnRlYW1zfHxlLnRlYW0hPT10aGlzLnRlYW0pKTsKICAgICAgaWYocGxheWVyRW50KXt0aGlzLnRhcmdldD1wbGF5ZXJFbnQ7fQogICAgICBlbHNlewogICAgICAgIGxldCBiZXN0PUluZmluaXR5OwogICAgICAgIGZvcihjb25zdCBlIG9mIGVudGl0aWVzKXsKICAgICAgICAgIGlmKGU9PT10aGlzKWNvbnRpbnVlOwogICAgICAgICAgaWYoY2hvc2VuTW9kZSYmY2hvc2VuTW9kZS50ZWFtcyYmZS50ZWFtPT09dGhpcy50ZWFtKWNvbnRpbnVlOwogICAgICAgICAgaWYoZS5kZWFkKWNvbnRpbnVlOwogICAgICAgICAgY29uc3QgZD1NYXRoLmh5cG90KGUueC10aGlzLngsZS55LXRoaXMueSk7CiAgICAgICAgICBpZihkPGJlc3Qpe2Jlc3Q9ZDt0aGlzLnRhcmdldD1lO30KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICAvLyDilIDilIAgT2JzdGFjbGUgKyBlZGdlIGF2b2lkYW5jZSBzdGVlcmluZyDilIDilIAKICAgIGNvbnN0IEFWT0lEX1I9NzA7CiAgICBsZXQgYXZvaWRYPTAsYXZvaWRZPTA7CiAgICAvLyBNYXAgZWRnZXMKICAgIGNvbnN0IGVkZ2VQdXNoPTU1OwogICAgaWYodGhpcy54PGVkZ2VQdXNoKWF2b2lkWCs9KGVkZ2VQdXNoLXRoaXMueCkvZWRnZVB1c2g7CiAgICBpZih0aGlzLng+QVctZWRnZVB1c2gpYXZvaWRYLT0odGhpcy54LShBVy1lZGdlUHVzaCkpL2VkZ2VQdXNoOwogICAgaWYodGhpcy55PGVkZ2VQdXNoKWF2b2lkWSs9KGVkZ2VQdXNoLXRoaXMueSkvZWRnZVB1c2g7CiAgICBpZih0aGlzLnk+QUgtZWRnZVB1c2gpYXZvaWRZLT0odGhpcy55LShBSC1lZGdlUHVzaCkpL2VkZ2VQdXNoOwogICAgLy8gT2JzdGFjbGVzCiAgICBmb3IoY29uc3Qgb2Igb2YgY3VycmVudE1hcC5vYnN0YWNsZXMpewogICAgICBjb25zdCBjeD1NYXRoLm1heChvYi54LE1hdGgubWluKG9iLngrb2Iudyx0aGlzLngpKTsKICAgICAgY29uc3QgY3k9TWF0aC5tYXgob2IueSxNYXRoLm1pbihvYi55K29iLmgsdGhpcy55KSk7CiAgICAgIGNvbnN0IGR4PXRoaXMueC1jeCxkeT10aGlzLnktY3ksZGlzdD1NYXRoLmh5cG90KGR4LGR5KTsKICAgICAgaWYoZGlzdDxBVk9JRF9SJiZkaXN0PjApewogICAgICAgIGNvbnN0IHN0cj0oQVZPSURfUi1kaXN0KS9BVk9JRF9SOwogICAgICAgIGF2b2lkWCs9ZHgvZGlzdCpzdHIqMi4yOwogICAgICAgIGF2b2lkWSs9ZHkvZGlzdCpzdHIqMi4yOwogICAgICB9CiAgICB9CiAgICBjb25zdCBhdm9pZExlbj1NYXRoLmh5cG90KGF2b2lkWCxhdm9pZFkpOwogICAgaWYoYXZvaWRMZW4+MSl7YXZvaWRYLz1hdm9pZExlbjthdm9pZFkvPWF2b2lkTGVuO30KCiAgICAvLyDilIDilIAgU3R1Y2sgZGV0ZWN0aW9uOiBpZiBiYXJlbHkgbW92ZWQgZm9yIDAuNnMsIGZvcmNlIG5ldyB3YW5kZXIg4pSA4pSACiAgICBpZighdGhpcy5fbGFzdFgpdGhpcy5fbGFzdFg9dGhpcy54OwogICAgaWYoIXRoaXMuX2xhc3RZKXRoaXMuX2xhc3RZPXRoaXMueTsKICAgIHRoaXMuX3N0dWNrVGltZXI9KHRoaXMuX3N0dWNrVGltZXJ8fDApK2R0OwogICAgaWYodGhpcy5fc3R1Y2tUaW1lcj4wLjYpewogICAgICBjb25zdCBtb3ZlZD1NYXRoLmh5cG90KHRoaXMueC10aGlzLl9sYXN0WCx0aGlzLnktdGhpcy5fbGFzdFkpOwogICAgICBpZihtb3ZlZDw4KXt0aGlzLndhbmRlckFuZ2xlPU1hdGgucmFuZG9tKCkqTWF0aC5QSSoyO3RoaXMuX2ZvcmNlZFdhbmRlcj0uNzt9CiAgICAgIHRoaXMuX2xhc3RYPXRoaXMueDt0aGlzLl9sYXN0WT10aGlzLnk7dGhpcy5fc3R1Y2tUaW1lcj0wOwogICAgfQogICAgaWYodGhpcy5fZm9yY2VkV2FuZGVyPjApewogICAgICB0aGlzLl9mb3JjZWRXYW5kZXItPWR0OwogICAgICBjb25zdCBzcGQ9dGhpcy5zcGVlZCoodGhpcy5wb3dTcGVlZD8xLjU1OjEpOwogICAgICB0aGlzLnZ4PU1hdGguY29zKHRoaXMud2FuZGVyQW5nbGUpKnNwZCthdm9pZFgqc3BkOwogICAgICB0aGlzLnZ5PU1hdGguc2luKHRoaXMud2FuZGVyQW5nbGUpKnNwZCthdm9pZFkqc3BkOwogICAgICB0aGlzLmFuZ2xlPXRoaXMud2FuZGVyQW5nbGU7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZighdGhpcy50YXJnZXQpewogICAgICB0aGlzLndhbmRlclRpbWVyLT1kdDsKICAgICAgaWYodGhpcy53YW5kZXJUaW1lcjw9MCl7dGhpcy53YW5kZXJBbmdsZT0oTWF0aC5yYW5kb20oKS0uNSkqTWF0aC5QSSoyO3RoaXMud2FuZGVyVGltZXI9LjUrTWF0aC5yYW5kb20oKSouODt9CiAgICAgIGNvbnN0IHNwZD10aGlzLnNwZWVkKih0aGlzLnBvd1NwZWVkPzEuNTU6MSkqLjU7CiAgICAgIHRoaXMudng9TWF0aC5jb3ModGhpcy53YW5kZXJBbmdsZSkqc3BkK2F2b2lkWCpzcGQ7CiAgICAgIHRoaXMudnk9TWF0aC5zaW4odGhpcy53YW5kZXJBbmdsZSkqc3BkK2F2b2lkWSpzcGQ7CiAgICAgIHRoaXMuYW5nbGU9TWF0aC5hdGFuMih0aGlzLnZ5LHRoaXMudngpOwogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgdHg9dGhpcy50YXJnZXQueCx0eT10aGlzLnRhcmdldC55OwogICAgY29uc3QgZD1NYXRoLmh5cG90KHR4LXRoaXMueCx0eS10aGlzLnkpOwogICAgY29uc3QgdG9UPU1hdGguYXRhbjIodHktdGhpcy55LHR4LXRoaXMueCk7CgogICAgLy8gQmxlbmQgYXZvaWQgaW50byBjaGFzZSBkaXJlY3Rpb24KICAgIGNvbnN0IGNoYXNlWD1NYXRoLmNvcyh0b1QpLGNoYXNlWT1NYXRoLnNpbih0b1QpOwogICAgY29uc3QgYXZvaWRXZWlnaHQ9TWF0aC5taW4oMSxhdm9pZExlbioxLjQpOwogICAgY29uc3QgYmxlbmRYPWNoYXNlWCooMS1hdm9pZFdlaWdodCkrYXZvaWRYKmF2b2lkV2VpZ2h0OwogICAgY29uc3QgYmxlbmRZPWNoYXNlWSooMS1hdm9pZFdlaWdodCkrYXZvaWRZKmF2b2lkV2VpZ2h0OwogICAgY29uc3QgYmxlbmRBbmdsZT1NYXRoLmF0YW4yKGJsZW5kWSxibGVuZFgpOwoKICAgIHRoaXMuYW5nbGU9dG9UOyAvLyBmYWNlIHRhcmdldCByZWdhcmRsZXNzIG9mIG1vdmVtZW50IGRpcgogICAgdGhpcy5zdGF0ZVRpbWVyLT1kdDsKICAgIGlmKHRoaXMuc3RhdGVUaW1lcjw9MCl7CiAgICAgIGlmKHRoaXMuaHA8PTEmJmQ+MTIwKXRoaXMuc3RhdGU9J3JldHJlYXQnOwogICAgICBlbHNlIGlmKGQ8U1dPUkRfUisyMil0aGlzLnN0YXRlPSdzdHJhZmUnOwogICAgICBlbHNlIHRoaXMuc3RhdGU9J2NoYXNlJzsKICAgICAgdGhpcy5zdGF0ZVRpbWVyPS4zNStNYXRoLnJhbmRvbSgpKi41OwogICAgfQoKICAgIC8vIFNob290CiAgICB0aGlzLmJvdEd1bkNELT1kdDsKICAgIGlmKGQ+OTAmJmQ8OTAwJiYhdGhpcy5yZWxvYWRpbmcmJnRoaXMuYW1tbz4wJiZ0aGlzLmJvdEd1bkNEPD0wKXsKICAgICAgY29uc3QgbGVhZD1kL3RoaXMuZ3VuLnNwZDsKICAgICAgY29uc3QgYWltWD10eCt0aGlzLnRhcmdldC52eCpsZWFkLGFpbVk9dHkrdGhpcy50YXJnZXQudnkqbGVhZDsKICAgICAgY29uc3QgYWltQT1NYXRoLmF0YW4yKGFpbVktdGhpcy55LGFpbVgtdGhpcy54KTsKICAgICAgY29uc3QgaW5hY2N1cmFjeT0uMjUqKDEtdGhpcy5hZ2dybyk7CiAgICAgIHRoaXMuc2hvb3QoYWltQSsoTWF0aC5yYW5kb20oKS0uNSkqaW5hY2N1cmFjeSk7CiAgICAgIHRoaXMuYm90R3VuQ0Q9dGhpcy5ndW4ucmF0ZSooMStNYXRoLnJhbmRvbSgpKi40KTsKICAgIH0KICAgIGlmKGQ8U1dPUkRfUis4KXRoaXMuc3RhcnRNZWxlZSgpOwoKICAgIGNvbnN0IHNkaXI9KCh0aGlzLmtpbGxzK3RoaXMuZGVhdGhzKSUyPT09MD8xOi0xKTsKICAgIGNvbnN0IHNwZD10aGlzLnNwZWVkKih0aGlzLnBvd1NwZWVkPzEuNTU6MSk7CiAgICBzd2l0Y2godGhpcy5zdGF0ZSl7CiAgICAgIGNhc2UnY2hhc2UnOgogICAgICAgIHRoaXMudng9TWF0aC5jb3MoYmxlbmRBbmdsZSkqc3BkOwogICAgICAgIHRoaXMudnk9TWF0aC5zaW4oYmxlbmRBbmdsZSkqc3BkOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlJ3N0cmFmZSc6ewogICAgICAgIGNvbnN0IHN0PXRvVCtNYXRoLlBJLzIqc2RpcjsKICAgICAgICBjb25zdCBzeD1NYXRoLmNvcyhzdCkqKDEtYXZvaWRXZWlnaHQpK2F2b2lkWCphdm9pZFdlaWdodDsKICAgICAgICBjb25zdCBzeT1NYXRoLnNpbihzdCkqKDEtYXZvaWRXZWlnaHQpK2F2b2lkWSphdm9pZFdlaWdodDsKICAgICAgICB0aGlzLnZ4PXN4KnNwZCouODU7dGhpcy52eT1zeSpzcGQqLjg1OwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGNhc2UncmV0cmVhdCc6CiAgICAgICAgdGhpcy52eD0oLWNoYXNlWCooMS1hdm9pZFdlaWdodCowLjUpK2F2b2lkWCphdm9pZFdlaWdodCowLjUpKnNwZCouOTsKICAgICAgICB0aGlzLnZ5PSgtY2hhc2VZKigxLWF2b2lkV2VpZ2h0KjAuNSkrYXZvaWRZKmF2b2lkV2VpZ2h0KjAuNSkqc3BkKi45OwogICAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgZHJhdygpewogICAgaWYodGhpcy5kZWFkKXJldHVybjsKICAgIGNvbnN0IGM9Y3R4OwogICAgYy5zYXZlKCk7Yy50cmFuc2xhdGUodGhpcy54LHRoaXMueSk7CiAgICAvLyBNZWxlZSBhcmMKICAgIGlmKHRoaXMuYXR0YWNraW5nKXsKICAgICAgY29uc3QgdD10aGlzLmF0a1RpbWVyL0FUS19EVVIsYXJjRW5kPXRoaXMuYXRrQW5nbGUtU1dPUkRfQVJDKygxLXQpKlNXT1JEX0FSQyoyOwogICAgICBjLmJlZ2luUGF0aCgpO2MubW92ZVRvKDAsMCk7Yy5hcmMoMCwwLFNXT1JEX1IsdGhpcy5hdGtBbmdsZS1TV09SRF9BUkMsYXJjRW5kKTtjLmNsb3NlUGF0aCgpOwogICAgICBjLmZpbGxTdHlsZT10aGlzLnRlYW09PT0ncmVkJz8ncmdiYSgyNTUsNDksNDksLjE3KSc6J3JnYmEoMzAsMTQ0LDI1NSwuMTcpJztjLmZpbGwoKTsKICAgICAgYy5zdHJva2VTdHlsZT10aGlzLnRlYW09PT0ncmVkJz8ncmdiYSgyNTUsNDksNDksLjUpJzoncmdiYSgzMCwxNDQsMjU1LC41KSc7Yy5saW5lV2lkdGg9MTtjLnN0cm9rZSgpOwogICAgfQogICAgLy8gR2xvdwogICAgYy5zaGFkb3dDb2xvcj10aGlzLmlzUGxheWVyP3RoaXMuc2tpbi5nbG93Q29sOnRoaXMudGVhbUdsb3c7Yy5zaGFkb3dCbHVyPXRoaXMuaXNQbGF5ZXI/Mjg6MTI7CiAgICAvLyBCb2R5CiAgICBjLmJlZ2luUGF0aCgpO2MuYXJjKDAsMCxSQUQsMCxNYXRoLlBJKjIpOwogICAgYy5maWxsU3R5bGU9dGhpcy5oaXRGbGFzaD4wPycjZmZmJzp0aGlzLnRlYW1Db2w7CiAgICBpZih0aGlzLmhpdEZsYXNoPjApYy5nbG9iYWxBbHBoYT0uNTUrdGhpcy5oaXRGbGFzaCoyLjU7CiAgICBjLmZpbGwoKTtjLmdsb2JhbEFscGhhPTE7Yy5zaGFkb3dCbHVyPTA7CiAgICAvLyBJbm5lciBza2luCiAgICBjLmJlZ2luUGF0aCgpO2MuYXJjKDAsMCxSQUQqLjcsMCxNYXRoLlBJKjIpO2MuZmlsbFN0eWxlPXRoaXMuc2tpbi5ib2R5Q29sO2MuZmlsbCgpOwogICAgdGhpcy5kcmF3U2tpbihjKTsKICAgIC8vIFNoaWVsZCByaW5nCiAgICBpZih0aGlzLnNoaWVsZD4wKXsKICAgICAgYy5iZWdpblBhdGgoKTtjLmFyYygwLDAsUkFEKzcsMCxNYXRoLlBJKjIpOwogICAgICBjLnN0cm9rZVN0eWxlPSdyZ2JhKDAsMjQ1LDI1NSwuNyknO2MubGluZVdpZHRoPTIuNTsKICAgICAgYy5zaGFkb3dDb2xvcj0nIzAwRjVGRic7Yy5zaGFkb3dCbHVyPTEwO2Muc3Ryb2tlKCk7Yy5zaGFkb3dCbHVyPTA7CiAgICB9CiAgICAvLyBQbGF5ZXIgcmluZwogICAgaWYodGhpcy5pc1BsYXllcil7Yy5iZWdpblBhdGgoKTtjLmFyYygwLDAsUkFEKzUsMCxNYXRoLlBJKjIpO2Muc3Ryb2tlU3R5bGU9J3JnYmEoMjU1LDIzMCwwLC44KSc7Yy5saW5lV2lkdGg9MjtjLnN0cm9rZSgpO30KICAgIC8vIFNwZWVkIHRyYWlsCiAgICBpZih0aGlzLnBvd1NwZWVkJiYoTWF0aC5hYnModGhpcy52eCkrTWF0aC5hYnModGhpcy52eSkpPjUwKXsKICAgICAgYy5zYXZlKCk7Yy5nbG9iYWxBbHBoYT0uMztjLmZpbGxTdHlsZT0nI0ZGRTYwMCc7CiAgICAgIGMuYmVnaW5QYXRoKCk7Yy5hcmMoLU1hdGguY29zKHRoaXMuYW5nbGUpKjEyLC1NYXRoLnNpbih0aGlzLmFuZ2xlKSoxMixSQUQqLjUsMCxNYXRoLlBJKjIpO2MuZmlsbCgpOwogICAgICBjLnJlc3RvcmUoKTsKICAgIH0KICAgIC8vIFN3b3JkCiAgICBjb25zdCBzYT10aGlzLmF0dGFja2luZz90aGlzLmF0a0FuZ2xlLVNXT1JEX0FSQysoMS10aGlzLmF0a1RpbWVyL0FUS19EVVIpKlNXT1JEX0FSQyoyOnRoaXMuYW5nbGU7CiAgICBjLnNhdmUoKTtjLnJvdGF0ZShzYSk7CiAgICBjLnNoYWRvd0NvbG9yPXRoaXMuYXR0YWNraW5nPydyZ2JhKDI1NSwyMzAsMCwuODUpJzondHJhbnNwYXJlbnQnO2Muc2hhZG93Qmx1cj10aGlzLmF0dGFja2luZz8xMjowOwogICAgYy5iZWdpblBhdGgoKTtjLm1vdmVUbyhSQUQtMSwtMS41KTtjLmxpbmVUbyhTV09SRF9SKi44NSwwKTsKICAgIGMuc3Ryb2tlU3R5bGU9dGhpcy5hdHRhY2tpbmc/JyNGRkU2MDAnOidyZ2JhKDIxMCwyMTUsMjMwLC44KSc7Yy5saW5lV2lkdGg9dGhpcy5hdHRhY2tpbmc/MzoyO2Muc3Ryb2tlKCk7CiAgICBjLmJlZ2luUGF0aCgpO2MubW92ZVRvKFJBRCs5LC03KTtjLmxpbmVUbyhSQUQrOSw3KTsKICAgIGMuc3Ryb2tlU3R5bGU9dGhpcy5hdHRhY2tpbmc/J3JnYmEoMjU1LDIzMCwwLC45KSc6J3JnYmEoMTkwLDE5NSwyMjAsLjcpJztjLmxpbmVXaWR0aD0yLjU7Yy5zdHJva2UoKTsKICAgIGMuc2hhZG93Qmx1cj0wO2MucmVzdG9yZSgpOwogICAgLy8gRGlyZWN0aW9uIGRvdAogICAgYy5iZWdpblBhdGgoKTtjLmFyYyhNYXRoLmNvcyh0aGlzLmFuZ2xlKSooUkFEKzQpLE1hdGguc2luKHRoaXMuYW5nbGUpKihSQUQrNCksMi41LDAsTWF0aC5QSSoyKTtjLmZpbGxTdHlsZT0ncmdiYSgyNTUsMjU1LDI1NSwuOSknO2MuZmlsbCgpOwogICAgLy8gQ1RGIGZsYWcKICAgIGlmKHRoaXMuaGFzRmxhZyl7CiAgICAgIGMuc2F2ZSgpO2MudHJhbnNsYXRlKDAsLVJBRC0xMik7CiAgICAgIGMuZmlsbFN0eWxlPXRoaXMuaGFzRmxhZy50ZWFtPT09J3JlZCc/JyNGRjMxMzEnOicjMUU5MEZGJzsKICAgICAgYy5mb250PScxNHB4IHNhbnMtc2VyaWYnO2MudGV4dEFsaWduPSdjZW50ZXInO2MuZmlsbFRleHQoJ/CfmqknLDAsMCk7CiAgICAgIGMucmVzdG9yZSgpOwogICAgfQogICAgYy5yZXN0b3JlKCk7CiAgICAvLyBIUCBiYXIKICAgIGNvbnN0IGJ3PTM2LGJoPTQsYng9dGhpcy54LWJ3LzIsYnk9dGhpcy55LVJBRC0xMzsKICAgIGMuZmlsbFN0eWxlPSdyZ2JhKDAsMCwwLC42NSknO2MuZmlsbFJlY3QoYngtMSxieS0xLGJ3KzIsYmgrMik7CiAgICBjLmZpbGxTdHlsZT10aGlzLmhwPT09MT8nI0ZGMzEzMSc6dGhpcy50ZWFtQ29sO2MuZmlsbFJlY3QoYngsYnksYncqKHRoaXMuaHAvTUFYX0hQKSxiaCk7CiAgICAvLyBOYW1lCiAgICBjLmZvbnQ9dGhpcy5pc1BsYXllcj8nYm9sZCAxMXB4IEJhcmxvdyBDb25kZW5zZWQsc2Fucy1zZXJpZic6JzcwMCA5cHggQmFybG93IENvbmRlbnNlZCxzYW5zLXNlcmlmJzsKICAgIGMudGV4dEFsaWduPSdjZW50ZXInO2MuZmlsbFN0eWxlPXRoaXMuaXNQbGF5ZXI/J3JnYmEoMjU1LDIzMCwwLC45NSknOidyZ2JhKDIwMCwyMTAsMjMwLC42KSc7CiAgICBjLmZpbGxUZXh0KHRoaXMuaXNQbGF5ZXI/J+KWtiBZT1UnOnRoaXMubmFtZSx0aGlzLngsdGhpcy55LVJBRC0xOCk7CiAgfQoKICBkcmF3U2tpbihjKXsKICAgIGMuc2F2ZSgpOwogICAgc3dpdGNoKHRoaXMuc2tpbi5zaGFwZSl7CiAgICAgIGNhc2UncmluZ3MnOmMuYmVnaW5QYXRoKCk7Yy5hcmMoMCwwLFJBRCouNDgsMCxNYXRoLlBJKjIpO2Muc3Ryb2tlU3R5bGU9dGhpcy5za2luLmFjY0NvbCsnYmInO2MubGluZVdpZHRoPTEuNTtjLnN0cm9rZSgpO2MuYmVnaW5QYXRoKCk7Yy5hcmMoMCwwLFJBRCouMjIsMCxNYXRoLlBJKjIpO2MuZmlsbFN0eWxlPXRoaXMuc2tpbi5hY2NDb2w7Yy5maWxsKCk7YnJlYWs7CiAgICAgIGNhc2UnZXllcyc6Wy01LDVdLmZvckVhY2goZXg9PntjLmJlZ2luUGF0aCgpO2MuYXJjKGV4LC0xLjUsMywwLE1hdGguUEkqMik7Yy5zaGFkb3dDb2xvcj0nI0ZGMDAwMCc7Yy5zaGFkb3dCbHVyPTc7Yy5maWxsU3R5bGU9JyNGRjAwMDAnO2MuZmlsbCgpO2Muc2hhZG93Qmx1cj0wO30pO2JyZWFrOwogICAgICBjYXNlJ3NvZnQnOmMuYmVnaW5QYXRoKCk7Yy5hcmMoMCwwLFJBRCouNDUsMCxNYXRoLlBJKjIpO2MuZmlsbFN0eWxlPSdyZ2JhKDI1NSwyNTUsMjU1LC4xOCknO2MuZmlsbCgpO1stNSw1XS5mb3JFYWNoKGV4PT57Yy5iZWdpblBhdGgoKTtjLmFyYyhleCwwLDIsMCxNYXRoLlBJKjIpO2MuZmlsbFN0eWxlPSdyZ2JhKDI1NSwyNTUsMjU1LC45KSc7Yy5maWxsKCk7fSk7YnJlYWs7CiAgICAgIGNhc2UnZmlyZSc6Zm9yKGxldCBpPTA7aTw4O2krKyl7Y29uc3QgYT0oaS84KSpNYXRoLlBJKjIrRGF0ZS5ub3coKSouMDA0O2MuYmVnaW5QYXRoKCk7Yy5hcmMoTWF0aC5jb3MoYSkqUkFEKi40LE1hdGguc2luKGEpKlJBRCouNCwyLDAsTWF0aC5QSSoyKTtjLmZpbGxTdHlsZT1pJTI9PT0wPycjRkY2NjAwJzonI0ZGRDcwMCc7Yy5maWxsKCk7fWMuYmVnaW5QYXRoKCk7Yy5hcmMoMCwwLFJBRCouMTgsMCxNYXRoLlBJKjIpO2MuZmlsbFN0eWxlPScjRkZENzAwJztjLmZpbGwoKTticmVhazsKICAgICAgY2FzZSdjcm9zcyc6Yy5iZWdpblBhdGgoKTtjLm1vdmVUbygtUkFEKi40MiwwKTtjLmxpbmVUbyhSQUQqLjQyLDApO2MubW92ZVRvKDAsLVJBRCouNDIpO2MubGluZVRvKDAsUkFEKi40Mik7Yy5zdHJva2VTdHlsZT10aGlzLnNraW4uYWNjQ29sO2MubGluZVdpZHRoPTIuNTtjLnNoYWRvd0NvbG9yPXRoaXMuc2tpbi5hY2NDb2w7Yy5zaGFkb3dCbHVyPTU7Yy5zdHJva2UoKTtjLnNoYWRvd0JsdXI9MDtjLmJlZ2luUGF0aCgpO2MuYXJjKDAsMCwzLjUsMCxNYXRoLlBJKjIpO2MuZmlsbFN0eWxlPXRoaXMuc2tpbi5hY2NDb2w7Yy5maWxsKCk7YnJlYWs7CiAgICAgIGNhc2UnemFwJzpjLmJlZ2luUGF0aCgpO2MubW92ZVRvKC1SQUQqLjMyLC1SQUQqLjMyKTtjLmxpbmVUbyhSQUQqLjA4LDApO2MubGluZVRvKC1SQUQqLjE1LFJBRCouMzIpO2Muc3Ryb2tlU3R5bGU9dGhpcy5za2luLmFjY0NvbDtjLmxpbmVXaWR0aD0yLjI7Yy5zaGFkb3dDb2xvcj10aGlzLnNraW4uYWNjQ29sO2Muc2hhZG93Qmx1cj02O2Muc3Ryb2tlKCk7Yy5zaGFkb3dCbHVyPTA7YnJlYWs7CiAgICB9CiAgICBjLnJlc3RvcmUoKTsKICB9Cn0KCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAovLyAgRkxBRyAoQ1RGKQovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKY2xhc3MgRmxhZyB7CiAgY29uc3RydWN0b3IodGVhbSl7CiAgICB0aGlzLnRlYW09dGVhbTsKICAgIHRoaXMuaG9tZVg9dGVhbT09PSdyZWQnP1NQQVdOX0MvMjpBVy1TUEFXTl9DLzI7CiAgICB0aGlzLmhvbWVZPUFILzI7CiAgICB0aGlzLng9dGhpcy5ob21lWDt0aGlzLnk9dGhpcy5ob21lWTsKICAgIHRoaXMuY2Fycmllcj1udWxsO3RoaXMuZHJvcHBlZD1mYWxzZTt0aGlzLmRyb3BUaW1lcj0wO3RoaXMuZGVhZD1mYWxzZTsKICB9CiAgdXBkYXRlKGR0KXsKICAgIGlmKHRoaXMuZHJvcHBlZCl7CiAgICAgIHRoaXMuZHJvcFRpbWVyLT1kdDsKICAgICAgaWYodGhpcy5kcm9wVGltZXI8PTApe3RoaXMueD10aGlzLmhvbWVYO3RoaXMueT10aGlzLmhvbWVZO3RoaXMuZHJvcHBlZD1mYWxzZTt9CiAgICB9CiAgICBpZih0aGlzLmNhcnJpZXIpe3RoaXMueD10aGlzLmNhcnJpZXIueDt0aGlzLnk9dGhpcy5jYXJyaWVyLnk7fQogIH0KICBkcmF3KCl7CiAgICBpZih0aGlzLmNhcnJpZXIpcmV0dXJuOwogICAgY29uc3QgYz1jdHgsYm9iPU1hdGguc2luKERhdGUubm93KCkqLjAwMikqNTsKICAgIGMuc2F2ZSgpO2MudHJhbnNsYXRlKHRoaXMueCx0aGlzLnkrYm9iLTE1KTsKICAgIGMuc2hhZG93Q29sb3I9dGhpcy50ZWFtPT09J3JlZCc/JyNGRjMxMzEnOicjMUU5MEZGJztjLnNoYWRvd0JsdXI9MTY7CiAgICBjLmZvbnQ9JzIycHggc2Fucy1zZXJpZic7Yy50ZXh0QWxpZ249J2NlbnRlcic7Yy50ZXh0QmFzZWxpbmU9J21pZGRsZSc7CiAgICBjLmZpbGxUZXh0KHRoaXMudGVhbT09PSdyZWQnPyfwn5qpJzon8J+PsycsMCwwKTsKICAgIGMucmVzdG9yZSgpOwogICAgLy8gQmFzZSBpbmRpY2F0b3IKICAgIGMuc2F2ZSgpO2MudHJhbnNsYXRlKHRoaXMuaG9tZVgsdGhpcy5ob21lWSk7CiAgICBjLmJlZ2luUGF0aCgpO2MuYXJjKDAsMCwyOCwwLE1hdGguUEkqMik7CiAgICBjLnN0cm9rZVN0eWxlPSh0aGlzLnRlYW09PT0ncmVkJz8ncmdiYSgyNTUsNDksNDksLjMpJzoncmdiYSgzMCwxNDQsMjU1LC4zKScpOwogICAgYy5zZXRMaW5lRGFzaChbNiw2XSk7Yy5saW5lV2lkdGg9MjtjLnN0cm9rZSgpO2Muc2V0TGluZURhc2goW10pOwogICAgYy5yZXN0b3JlKCk7CiAgfQp9CgovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKLy8gIEhFTFBFUlMKLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCmZ1bmN0aW9uIHB1c2hPdXQoZSxyKXsKICBjb25zdCBjeD1NYXRoLm1heChyLngsTWF0aC5taW4oci54K3IudyxlLngpKSxjeT1NYXRoLm1heChyLnksTWF0aC5taW4oci55K3IuaCxlLnkpKTsKICBjb25zdCBkeD1lLngtY3gsZHk9ZS55LWN5LGQ9TWF0aC5oeXBvdChkeCxkeSk7CiAgaWYoZD09PTApe2UueD1yLngrci53LzI7fWVsc2UgaWYoZDxSQUQpe2NvbnN0IG92PVJBRC1kO2UueCs9KGR4L2QpKm92O2UueSs9KGR5L2QpKm92O30KfQpmdW5jdGlvbiByZXNvbHZlQ29sbGlzaW9ucygpewogIGZvcihsZXQgaT0wO2k8ZW50aXRpZXMubGVuZ3RoO2krKyl7Zm9yKGxldCBqPWkrMTtqPGVudGl0aWVzLmxlbmd0aDtqKyspewogICAgY29uc3QgYT1lbnRpdGllc1tpXSxiPWVudGl0aWVzW2pdO2lmKGEuZGVhZHx8Yi5kZWFkKWNvbnRpbnVlOwogICAgY29uc3QgZHg9Yi54LWEueCxkeT1iLnktYS55LGQ9TWF0aC5oeXBvdChkeCxkeSksbWluPVJBRCoyOwogICAgaWYoZDxtaW4mJmQ+MCl7Y29uc3QgcD0obWluLWQpLzI7YS54LT0oZHgvZCkqcDthLnktPShkeS9kKSpwO2IueCs9KGR4L2QpKnA7Yi55Kz0oZHkvZCkqcDt9CiAgfX0KfQpmdW5jdGlvbiBzaGFrZShtYWcpe3NoYWtlTWFnPU1hdGgubWF4KHNoYWtlTWFnLG1hZyk7fQoKZnVuY3Rpb24gYXBwbHlQb3dlcnVwKGUsdHlwZSl7CiAgc3dpdGNoKHR5cGUuaWQpewogICAgY2FzZSdoZWFsdGgnOmlmKGUuaHA8TUFYX0hQKXtlLmhwPU1hdGgubWluKE1BWF9IUCxlLmhwKzEpO2lmKGUuaXNQbGF5ZXIpdXBkSHBIdWQoKTt9YnJlYWs7CiAgICBjYXNlJ3NwZWVkJzplLnBvd1NwZWVkPXRydWU7ZS5wb3dTcGVlZFRpbWVyPTU7ZS5zcGVlZD0oZS5pc1BsYXllcj9QX1NQRUVEOkJfU1BFRUQpKjEuNTU7YnJlYWs7CiAgICBjYXNlJ2RhbWFnZSc6ZS5wb3dEYW1hZ2U9dHJ1ZTtlLnBvd0RhbWFnZVRpbWVyPTU7YnJlYWs7CiAgICBjYXNlJ3NoaWVsZCc6ZS5zaGllbGQ9MjticmVhazsKICB9CiAgaWYoZS5pc1BsYXllcil7CiAgICBzaG93UG93QmFubmVyKHR5cGUubGFiZWwrJyEnKTsKICAgIHVwZEhwSHVkKCk7dXBkUG93SHVkKCk7CiAgfQp9CgpmdW5jdGlvbiBjYXBGbGFnKGNhcnJpZXIpewogIGNvbnN0IGY9Y2Fycmllci5oYXNGbGFnOwogIGN0ZkNhcHNbY2Fycmllci50ZWFtXSsrOwogIGNhcnJpZXIuc2NvcmUrPTMwMDsKICBmLng9Zi5ob21lWDtmLnk9Zi5ob21lWTtmLmRyb3BwZWQ9ZmFsc2U7Zi5jYXJyaWVyPW51bGw7Y2Fycmllci5oYXNGbGFnPW51bGw7CiAgYWRkRmVlZChjYXJyaWVyLm5hbWUsJ0ZMQUcgQ0FQJyxjYXJyaWVyLnRlYW0pOwogIHVwZEN0Zkh1ZCgpO2NoZWNrV2luKCk7CiAgc2hha2UoMTIpOwogIHNwYXduQnVyc3QoY2Fycmllci54LGNhcnJpZXIueSxjYXJyaWVyLnRlYW09PT0ncmVkJz8nI0ZGMzEzMSc6JyMxRTkwRkYnLDM1LHRydWUpOwp9CgpmdW5jdGlvbiBzcGF3blJhbmRvbVBvd2VydXAoKXsKICBsZXQgeCx5LHNhZmU9ZmFsc2UsdD0wOwogIHdoaWxlKCFzYWZlJiZ0PDMwKXsKICAgIHg9U1BBV05fQyszMCtNYXRoLnJhbmRvbSgpKihBVy1TUEFXTl9DKjItNjApOwogICAgeT02MCtNYXRoLnJhbmRvbSgpKihBSC0xMjApOwogICAgc2FmZT10cnVlOwogICAgZm9yKGNvbnN0IG9iIG9mIGN1cnJlbnRNYXAub2JzdGFjbGVzKXtpZih4Pm9iLngtMjAmJng8b2IueCtvYi53KzIwJiZ5Pm9iLnktMjAmJnk8b2IueStvYi5oKzIwKXtzYWZlPWZhbHNlO2JyZWFrO319CiAgICB0Kys7CiAgfQogIGNvbnN0IHR5cGU9UE9XX1RZUEVTW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSpQT1dfVFlQRVMubGVuZ3RoKV07CiAgcG93ZXJ1cHMucHVzaChuZXcgUG93ZXJ1cCh4LHksdHlwZSkpOwp9CgovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKLy8gIEtPVEggWk9ORQovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKZnVuY3Rpb24gdXBkYXRlS09USChkdCl7CiAgY29uc3Qgeng9QVcvMix6eT1BSC8yLHpyPTg1OwogIGxldCBpblpvbmU9e3JlZDowLGJsdWU6MH07CiAgZm9yKGNvbnN0IGUgb2YgZW50aXRpZXMpewogICAgaWYoZS5kZWFkKWNvbnRpbnVlOwogICAgaWYoTWF0aC5oeXBvdChlLngtengsZS55LXp5KTx6cilpblpvbmVbZS50ZWFtXT0oaW5ab25lW2UudGVhbV18fDApKzE7CiAgfQogIGNvbnN0IHdpbm5lcj1pblpvbmUucmVkPmluWm9uZS5ibHVlPydyZWQnOmluWm9uZS5ibHVlPmluWm9uZS5yZWQ/J2JsdWUnOm51bGw7CiAgaWYod2lubmVyKXsKICAgIGtvdGhTY29yZVt3aW5uZXJdKz1kdDsKICAgIHVwZEtvdGhIdWQoKTsKICAgIGNoZWNrV2luKCk7CiAgfQp9CmZ1bmN0aW9uIGRyYXdLb3RoWm9uZSgpewogIGNvbnN0IGM9Y3R4LHp4PUFXLzIsenk9QUgvMix6cj04NTsKICBjLnNhdmUoKTsKICBjLmJlZ2luUGF0aCgpO2MuYXJjKHp4LHp5LHpyLDAsTWF0aC5QSSoyKTsKICBjLmZpbGxTdHlsZT0ncmdiYSgyNTUsMjMwLDAsLjA0KSc7Yy5maWxsKCk7CiAgYy5zdHJva2VTdHlsZT0ncmdiYSgyNTUsMjMwLDAsLjM1KSc7Yy5saW5lV2lkdGg9MjtjLnNldExpbmVEYXNoKFsxMCw4XSk7Yy5zdHJva2UoKTtjLnNldExpbmVEYXNoKFtdKTsKICBjLmZvbnQ9J2JvbGQgOXB4IEJhcmxvdyBDb25kZW5zZWQsc2Fucy1zZXJpZic7Yy50ZXh0QWxpZ249J2NlbnRlcic7Yy5maWxsU3R5bGU9J3JnYmEoMjU1LDIzMCwwLC4zNSknO2MuZmlsbFRleHQoJ0tJTkcgT0YgVEhFIEhJTEwnLHp4LHp5K3pyKzE0KTsKICBjLnJlc3RvcmUoKTsKfQoKLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCi8vICBIVUQKLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCmZ1bmN0aW9uIHVwZFNjb3JlSHVkKCl7CiAgY29uc3QgbT1jaG9zZW5Nb2RlOwogIGlmKG0uaWQ9PT0ndGRtJyl7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3InKS50ZXh0Q29udGVudD1raWxscy5yZWQ7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2IyJykudGV4dENvbnRlbnQ9a2lsbHMuYmx1ZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzcicpLmNsYXNzTmFtZT0nc24yIHJlZCc7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2IyJykuY2xhc3NOYW1lPSdzbjIgYmx1ZSc7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3NlcCcpLmlubmVySFRNTD0nS0lMTFM8YnI+VE8gJyttLnRhcmdldDsKICB9ZWxzZSBpZihtLmlkPT09J2ZmYScpewogICAgY29uc3QgdG9wPU9iamVjdC5lbnRyaWVzKGZmYVNjb3JlKS5zb3J0KChhLGIpPT5iWzFdLWFbMV0pWzBdOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NyJykudGV4dENvbnRlbnQ9dG9wP3RvcFsxXTowOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NiMicpLnRleHRDb250ZW50PW0udGFyZ2V0OwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NyJykuY2xhc3NOYW1lPSdzbjIgZmZhJzsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYjInKS5jbGFzc05hbWU9J3NuMiBmZmEnOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NzZXAnKS5pbm5lckhUTUw9J0xFQUQ8YnI+VE8gV0lOJzsKICB9ZWxzZSBpZihtLmlkPT09J2tvdGgnKXsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzcicpLnRleHRDb250ZW50PU1hdGguZmxvb3Ioa290aFNjb3JlLnJlZCkrJ3MnOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NiMicpLnRleHRDb250ZW50PU1hdGguZmxvb3Ioa290aFNjb3JlLmJsdWUpKydzJzsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzcicpLmNsYXNzTmFtZT0nc24yIHJlZCc7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2IyJykuY2xhc3NOYW1lPSdzbjIgYmx1ZSc7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3NlcCcpLmlubmVySFRNTD0nWk9ORTxicj4nK20udGFyZ2V0KydzJzsKICB9ZWxzZSBpZihtLmlkPT09J2N0ZicpewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NyJykudGV4dENvbnRlbnQ9Y3RmQ2Fwcy5yZWQ7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2IyJykudGV4dENvbnRlbnQ9Y3RmQ2Fwcy5ibHVlOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NyJykuY2xhc3NOYW1lPSdzbjIgcmVkJzsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYjInKS5jbGFzc05hbWU9J3NuMiBibHVlJzsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzc2VwJykuaW5uZXJIVE1MPSdDQVBTPGJyPlRPICcrbS50YXJnZXQ7CiAgfWVsc2UgaWYobS5pZD09PSdndW4nKXsKICAgIGNvbnN0IGdpPUdVTl9PUkRFUi5pbmRleE9mKHBsYXllcj9wbGF5ZXIuZ3VuLmlkOidwaXN0b2wnKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzcicpLnRleHRDb250ZW50PWdpKzE7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2IyJykudGV4dENvbnRlbnQ9R1VOX09SREVSLmxlbmd0aDsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzcicpLmNsYXNzTmFtZT0nc24yIGZmYSc7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2IyJykuY2xhc3NOYW1lPSdzbjIgZmZhJzsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzc2VwJykuaW5uZXJIVE1MPSdXRUFQT048YnI+VElFUic7CiAgfQp9CmZ1bmN0aW9uIHVwZFN0YXRzSHVkKCl7CiAgaWYoIXBsYXllcilyZXR1cm47CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21rJykudGV4dENvbnRlbnQ9cGxheWVyLmtpbGxzOwogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZCcpLnRleHRDb250ZW50PXBsYXllci5kZWF0aHM7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zJykudGV4dENvbnRlbnQ9cGxheWVyLnN0cmVhazsKfQpmdW5jdGlvbiB1cGRIcEh1ZCgpewogIGlmKCFwbGF5ZXIpcmV0dXJuOwogIGZvcihsZXQgaT0xO2k8PTM7aSsrKWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoJytpKS5jbGFzc0xpc3QudG9nZ2xlKCdlJyxpPnBsYXllci5ocCk7CiAgY29uc3Qgc2Q9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaWVsZC1kaXNwbGF5Jyk7CiAgc2QuaW5uZXJIVE1MPXBsYXllci5zaGllbGQ+MD8n8J+boe+4jycucmVwZWF0KHBsYXllci5zaGllbGQpOicnOwp9CmZ1bmN0aW9uIHVwZEFtbW9IdWQoKXsKICBpZighcGxheWVyKXJldHVybjsKICBjb25zdCBnPXBsYXllci5ndW47CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hnbmFtZScpLnRleHRDb250ZW50PWcubmFtZTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGduYW1lJykuc3R5bGUuY29sb3I9Zy5jb2w7CiAgY29uc3QgYnA9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hidWxsZXRzJyk7YnAuaW5uZXJIVE1MPScnOwogIGNvbnN0IG1heD1NYXRoLm1pbihnLm1heEFtbW8sMzApOwogIGZvcihsZXQgaT0wO2k8bWF4O2krKyl7CiAgICBjb25zdCBkPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO2QuY2xhc3NOYW1lPSdicGlwJzsKICAgIGQuc3R5bGUuYmFja2dyb3VuZD1pPHBsYXllci5hbW1vP2cuY29sOidyZ2JhKDI1NSwyNTUsMjU1LC4xKSc7CiAgICBkLnN0eWxlLmhlaWdodD1nLmlkPT09J3NuaXBlcic/JzEzcHgnOic5cHgnOwogICAgYnAuYXBwZW5kQ2hpbGQoZCk7CiAgfQogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdocmVsb2FkJykuc3R5bGUuZGlzcGxheT1wbGF5ZXIucmVsb2FkaW5nPydibG9jayc6J25vbmUnOwp9CmZ1bmN0aW9uIHVwZFBvd0h1ZCgpewogIGlmKCFwbGF5ZXIpcmV0dXJuOwogIGNvbnN0IGhwPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdocG93Jyk7aHAuaW5uZXJIVE1MPScnOwogIGlmKHBsYXllci5wb3dTcGVlZCl7Y29uc3Qgcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7cy5jbGFzc05hbWU9J3Bvdy1waXAnO3MudGl0bGU9J1NwZWVkIEJvb3N0JztzLnRleHRDb250ZW50PSfimqEnO2hwLmFwcGVuZENoaWxkKHMpO30KICBpZihwbGF5ZXIucG93RGFtYWdlKXtjb25zdCBzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtzLmNsYXNzTmFtZT0ncG93LXBpcCc7cy50aXRsZT0nRGFtYWdlIEFtcCc7cy50ZXh0Q29udGVudD0n8J+UpSc7aHAuYXBwZW5kQ2hpbGQocyk7fQp9CmZ1bmN0aW9uIHVwZEd1bkdhbWVIdWQoKXsKICBpZihjaG9zZW5Nb2RlLmlkIT09J2d1bicpcmV0dXJuOwogIGNvbnN0IGdpPUdVTl9PUkRFUi5pbmRleE9mKHBsYXllci5ndW4uaWQpOwogIGNvbnN0IGVsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZ3VuJyk7CiAgZWwuc3R5bGUuZGlzcGxheT0nYmxvY2snOwogIGVsLnRleHRDb250ZW50PWBXRUFQT04gJHtnaSsxfS8ke0dVTl9PUkRFUi5sZW5ndGh9OiAke3BsYXllci5ndW4ubmFtZX1gOwogIGVsLnN0eWxlLmNvbG9yPXBsYXllci5ndW4uY29sOwogIHVwZFNjb3JlSHVkKCk7Cn0KZnVuY3Rpb24gdXBkS290aEh1ZCgpewogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrci1zJykudGV4dENvbnRlbnQ9TWF0aC5mbG9vcihrb3RoU2NvcmUucmVkKSsncyc7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2tiLXMnKS50ZXh0Q29udGVudD1NYXRoLmZsb29yKGtvdGhTY29yZS5ibHVlKSsncyc7CiAgY29uc3QgdD1jaG9zZW5Nb2RlLnRhcmdldDsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna3ItZmlsbCcpLnN0eWxlLndpZHRoPShrb3RoU2NvcmUucmVkL3QqMTAwKS50b0ZpeGVkKDEpKyclJzsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna2ItZmlsbCcpLnN0eWxlLndpZHRoPShrb3RoU2NvcmUuYmx1ZS90KjEwMCkudG9GaXhlZCgxKSsnJSc7CiAgdXBkU2NvcmVIdWQoKTsKfQpmdW5jdGlvbiB1cGRDdGZIdWQoKXsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3RmLXInKS50ZXh0Q29udGVudD1jdGZDYXBzLnJlZDsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3RmLWInKS50ZXh0Q29udGVudD1jdGZDYXBzLmJsdWU7CiAgdXBkU2NvcmVIdWQoKTsKfQpmdW5jdGlvbiBhZGRGZWVkKGtpbGxlcix2aWN0aW0sdGVhbSl7CiAgZmVlZEl0ZW1zLnVuc2hpZnQoe2tpbGxlcix2aWN0aW0sdGVhbSxsaWZlOjQuNX0pOwogIGlmKGZlZWRJdGVtcy5sZW5ndGg+NSlmZWVkSXRlbXMucG9wKCk7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hmZWVkJykuaW5uZXJIVE1MPWZlZWRJdGVtcy5tYXAoaz0+CiAgICBgPGRpdiBjbGFzcz0ia2YgJHtrLnRlYW19Ij48c3BhbiBjbGFzcz0ia2siPiR7ay5raWxsZXIuc2xpY2UoMCw5KX08L3NwYW4+PHNwYW4gY2xhc3M9ImtzZXAiPiDimpQgPC9zcGFuPjxzcGFuIGNsYXNzPSJrdiI+JHtrLnZpY3RpbS5zbGljZSgwLDkpfTwvc3Bhbj48L2Rpdj5gCiAgKS5qb2luKCcnKTsKfQpmdW5jdGlvbiBzZXRSZXNwYXduVUkobil7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hyZXNwYXduJykuY2xhc3NMaXN0LmFkZCgnc2hvdycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyc2MnKS50ZXh0Q29udGVudD1NYXRoLm1heCgwLG4pO30KZnVuY3Rpb24gaGlkZVJlc3Bhd25VSSgpe2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdocmVzcGF3bicpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTt9CgpsZXQgc3RyZWFrVGltZW91dDsKZnVuY3Rpb24gc2hvd1N0cmVhayh0eHQpewogIGNsZWFyVGltZW91dChzdHJlYWtUaW1lb3V0KTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2ItdGV4dCcpLnRleHRDb250ZW50PXR4dDsKICBjb25zdCBiPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdHJlYWstYmFubmVyJyk7Yi5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgdm9pZCBiLm9mZnNldFdpZHRoO2IuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogIHN0cmVha1RpbWVvdXQ9c2V0VGltZW91dCgoKT0+Yi5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JyksMjIwMCk7Cn0KbGV0IHBvd0Jhbm5lclRPOwpmdW5jdGlvbiBzaG93UG93QmFubmVyKHR4dCl7CiAgY2xlYXJUaW1lb3V0KHBvd0Jhbm5lclRPKTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGItdGV4dCcpLnRleHRDb250ZW50PXR4dDsKICBjb25zdCBiPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3ctYmFubmVyJyk7Yi5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgdm9pZCBiLm9mZnNldFdpZHRoO2IuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogIHBvd0Jhbm5lclRPPXNldFRpbWVvdXQoKCk9PmIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpLDE4MDApOwp9CgovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKLy8gIFdJTiBDSEVDSwovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKZnVuY3Rpb24gY2hlY2tXaW4oKXsKICBjb25zdCBtPWNob3Nlbk1vZGUsdD1tLnRhcmdldDsKICBpZihtLmlkPT09J3RkbScpICAgICB7aWYoa2lsbHMucmVkPj10KWVuZFJvdW5kKCdSRUQgVEVBTScsa2lsbHMucmVkPmtpbGxzLmJsdWU/J3JlZCc6J2JsdWUnKTtlbHNlIGlmKGtpbGxzLmJsdWU+PXQpZW5kUm91bmQoJ0JMVUUgVEVBTScsJ2JsdWUnKTt9CiAgZWxzZSBpZihtLmlkPT09J2ZmYScpe2NvbnN0IHRvcD1PYmplY3QuZW50cmllcyhmZmFTY29yZSkuc29ydCgoYSxiKT0+YlsxXS1hWzFdKVswXTtpZih0b3AmJnRvcFsxXT49dCllbmRSb3VuZCh0b3BbMF0rJyBXSU5TJywnZmZhJyk7fQogIGVsc2UgaWYobS5pZD09PSdrb3RoJyl7aWYoa290aFNjb3JlLnJlZD49dCllbmRSb3VuZCgnUkVEIFRFQU0nLCdyZWQnKTtlbHNlIGlmKGtvdGhTY29yZS5ibHVlPj10KWVuZFJvdW5kKCdCTFVFIFRFQU0nLCdibHVlJyk7fQogIGVsc2UgaWYobS5pZD09PSdjdGYnKXtpZihjdGZDYXBzLnJlZD49dCllbmRSb3VuZCgnUkVEIFRFQU0nLCdyZWQnKTtlbHNlIGlmKGN0ZkNhcHMuYmx1ZT49dCllbmRSb3VuZCgnQkxVRSBURUFNJywnYmx1ZScpO30KICBlbHNlIGlmKG0uaWQ9PT0nZ3VuJyl7CiAgICBjb25zdCBnaT1HVU5fT1JERVIuaW5kZXhPZihwbGF5ZXIuZ3VuLmlkKTsKICAgIGlmKGdpPT09R1VOX09SREVSLmxlbmd0aC0xJiZwbGF5ZXIua2lsbHM+MCllbmRSb3VuZChwbGF5ZXIubmFtZSsnIFdJTlMnLCd5b3UnKTsKICAgIGZvcihjb25zdCBlIG9mIGVudGl0aWVzKXsKICAgICAgaWYoZT09PXBsYXllcnx8ZS5kZWFkKWNvbnRpbnVlOwogICAgICBjb25zdCBlZ2k9R1VOX09SREVSLmluZGV4T2YoZS5ndW4uaWQpOwogICAgICBpZihlZ2k9PT1HVU5fT1JERVIubGVuZ3RoLTEmJmUua2lsbHM+MCllbmRSb3VuZChlLm5hbWUrJyBXSU5TJyxlLnRlYW0pOwogICAgfQogIH0KfQoKZnVuY3Rpb24gZW5kUm91bmQod2lubmVyVGV4dCwgd2lubmVyVGVhbSl7CiAgcnVubmluZz1mYWxzZTsKICBjb25zdCB3b249d2lubmVyVGVhbT09PSd5b3UnfHwoY2hvc2VuTW9kZS50ZWFtcyYmd2lubmVyVGVhbT09PWNob3NlblRlYW0pfHwoY2hvc2VuTW9kZS5pZD09PSdmZmEnJiZ3aW5uZXJUZXh0LnN0YXJ0c1dpdGgocGxheWVyTmFtZSkpOwogIGNvbnN0IGZsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmbGFzaCcpOwogIGZsLnN0eWxlLmJhY2tncm91bmQ9d29uPydyZ2JhKDI1NSwyMzAsMCwuMTQpJzoncmdiYSgyNTUsNDksNDksLjE0KSc7CiAgZmwuc3R5bGUub3BhY2l0eT0nMSc7CiAgc2V0VGltZW91dCgoKT0+e2ZsLnN0eWxlLm9wYWNpdHk9JzAnO30sNzAwKTsKICBzZXRUaW1lb3V0KCgpPT57CiAgICBjb25zdCBldD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXQnKTsKICAgIGV0LnRleHRDb250ZW50PXdvbj8n8J+PhiBWSUNUT1JZISAnK3dpbm5lclRleHQ6d2lubmVyVGV4dCsnIFdJTlMhJzsKICAgIGV0LmNsYXNzTmFtZT0nZXd0ICcrKHdvbj8neW91Jzp3aW5uZXJUZWFtPT09J2ZmYSc/J2ZmYSc6d2lubmVyVGVhbSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXMnKS50ZXh0Q29udGVudD1jaG9zZW5Nb2RlLm5hbWUrJyDigJQgUk9VTkQgT1ZFUic7CiAgICBidWlsZFNjb3JlYm9hcmQoKTsKICAgIHNob3dTY3JlZW4oJ3MtZW5kJyk7CiAgfSw4NTApOwp9CgpmdW5jdGlvbiBidWlsZFNjb3JlYm9hcmQoKXsKICBjb25zdCBhbGw9Wy4uLmVudGl0aWVzXS5zb3J0KChhLGIpPT5iLnNjb3JlLWEuc2NvcmUpOwogIGNvbnN0IHRiPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYi1ib2R5Jyk7dGIuaW5uZXJIVE1MPScnOwogIGFsbC5mb3JFYWNoKChlLGkpPT57CiAgICBjb25zdCBrZD1lLmRlYXRocz4wPyhlLmtpbGxzL2UuZGVhdGhzKS50b0ZpeGVkKDIpOmUua2lsbHMrJy4wMCc7CiAgICBjb25zdCB0cj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOwogICAgaWYoZS5pc1BsYXllcil0ci5jbGFzc05hbWU9J2hpZ2hsaWdodCc7CiAgICBjb25zdCB0ZWFtTGFiZWw9ZS50ZWFtPT09J3JlZCc/YDxzcGFuIGNsYXNzPSJzYi10ZWFtLXIiPlJFRDwvc3Bhbj5gOmA8c3BhbiBjbGFzcz0ic2ItdGVhbS1iIj5CTFVFPC9zcGFuPmA7CiAgICB0ci5pbm5lckhUTUw9YDx0ZD4ke2k9PT0wPyfwn5GRJzonIycrKGkrMSl9PC90ZD48dGQ+JHtlLmlzUGxheWVyPyc8Yj4nK2UubmFtZSsnIOKXgDwvYj4nOmUubmFtZX08L3RkPjx0ZD4ke2Nob3Nlbk1vZGUudGVhbXM/dGVhbUxhYmVsOidGRkEnfTwvdGQ+PHRkIGNsYXNzPSJzYi1rIj4ke2Uua2lsbHN9PC90ZD48dGQ+JHtlLmRlYXRoc308L3RkPjx0ZCBjbGFzcz0ic2Ita2QiPiR7a2R9PC90ZD48dGQgY2xhc3M9InNiLXdpbiI+JHtlLnNjb3JlLnRvTG9jYWxlU3RyaW5nKCl9PC90ZD5gOwogICAgdGIuYXBwZW5kQ2hpbGQodHIpOwogIH0pOwp9CgovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKLy8gIEFSRU5BCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkApmdW5jdGlvbiBkcmF3QXJlbmEoKXsKICBjb25zdCB0PWN1cnJlbnRNYXAudGhlbWUsYz1jdHg7CiAgYy5maWxsU3R5bGU9dC5mbG9vcjtjLmZpbGxSZWN0KDAsMCxBVyxBSCk7CiAgYy5zdHJva2VTdHlsZT10LmdyaWQ7Yy5saW5lV2lkdGg9MTsKICBmb3IobGV0IHg9MDt4PD1BVzt4Kz01NSl7Yy5iZWdpblBhdGgoKTtjLm1vdmVUbyh4LDApO2MubGluZVRvKHgsQUgpO2Muc3Ryb2tlKCk7fQogIGZvcihsZXQgeT0wO3k8PUFIO3krPTU1KXtjLmJlZ2luUGF0aCgpO2MubW92ZVRvKDAseSk7Yy5saW5lVG8oQVcseSk7Yy5zdHJva2UoKTt9CiAgYy5zdHJva2VTdHlsZT10LndhO2MubGluZVdpZHRoPTIuNTtjLnN0cm9rZVJlY3QoMywzLEFXLTYsQUgtNik7CiAgY29uc3QgY3M9MjIsYnB0cz1bWzAsMCwxLDFdLFtBVywwLC0xLDFdLFswLEFILDEsLTFdLFtBVyxBSCwtMSwtMV1dOwogIGMuc3Ryb2tlU3R5bGU9dC53YTtjLmxpbmVXaWR0aD0yLjU7CiAgYnB0cy5mb3JFYWNoKChbYngsYnksc3gsc3ldKT0+e2MuYmVnaW5QYXRoKCk7Yy5tb3ZlVG8oYngrc3gqY3MsYnkpO2MubGluZVRvKGJ4LGJ5KTtjLmxpbmVUbyhieCxieStzeSpjcyk7Yy5zdHJva2UoKTt9KTsKICBjLmZpbGxTdHlsZT0ncmdiYSgyNTUsNDksNDksLjA0KSc7Yy5maWxsUmVjdCgwLDAsU1BBV05fQyxBSCk7CiAgYy5maWxsU3R5bGU9J3JnYmEoMzAsMTQ0LDI1NSwuMDQpJztjLmZpbGxSZWN0KEFXLVNQQVdOX0MsMCxTUEFXTl9DLEFIKTsKICBjLnNldExpbmVEYXNoKFs4LDEwXSk7CiAgYy5zdHJva2VTdHlsZT0ncmdiYSgyNTUsNDksNDksLjEyKSc7Yy5saW5lV2lkdGg9MTtjLmJlZ2luUGF0aCgpO2MubW92ZVRvKFNQQVdOX0MsMCk7Yy5saW5lVG8oU1BBV05fQyxBSCk7Yy5zdHJva2UoKTsKICBjLnN0cm9rZVN0eWxlPSdyZ2JhKDMwLDE0NCwyNTUsLjEyKSc7Yy5iZWdpblBhdGgoKTtjLm1vdmVUbyhBVy1TUEFXTl9DLDApO2MubGluZVRvKEFXLVNQQVdOX0MsQUgpO2Muc3Ryb2tlKCk7CiAgYy5zZXRMaW5lRGFzaChbXSk7CiAgYy5mb250PSdib2xkIDEwcHggQmFybG93IENvbmRlbnNlZCxzYW5zLXNlcmlmJztjLnRleHRBbGlnbj0nY2VudGVyJzsKICBjLmZpbGxTdHlsZT0ncmdiYSgyNTUsNDksNDksLjIyKSc7Yy5maWxsVGV4dCgnUkVEIFNQQVdOJyxTUEFXTl9DLzIsMjQpOwogIGMuZmlsbFN0eWxlPSdyZ2JhKDMwLDE0NCwyNTUsLjIyKSc7Yy5maWxsVGV4dCgnQkxVRSBTUEFXTicsQVctU1BBV05fQy8yLDI0KTsKICBjLnNhdmUoKTtjLmdsb2JhbEFscGhhPS4wMjI7Yy5mb250PSdib2xkIDIwMHB4IEJhcmxvdyBDb25kZW5zZWQsc2Fucy1zZXJpZic7Yy50ZXh0QWxpZ249J2NlbnRlcic7Yy5maWxsU3R5bGU9JyNmZmYnO2MuZmlsbFRleHQoJ1JJVkFMUycsQVcvMixBSC8yKzY1KTtjLnJlc3RvcmUoKTsKICBmb3IoY29uc3Qgb2Igb2YgY3VycmVudE1hcC5vYnN0YWNsZXMpewogICAgYy5maWxsU3R5bGU9dC53ZjtjLmZpbGxSZWN0KG9iLngsb2IueSxvYi53LG9iLmgpOwogICAgYy5zdHJva2VTdHlsZT10LndzO2MubGluZVdpZHRoPTI7Yy5zdHJva2VSZWN0KG9iLngsb2IueSxvYi53LG9iLmgpOwogICAgYy5zYXZlKCk7Yy5iZWdpblBhdGgoKTtjLnJlY3Qob2IueCxvYi55LG9iLncsb2IuaCk7Yy5jbGlwKCk7CiAgICBjLnN0cm9rZVN0eWxlPXQuc3Q7Yy5saW5lV2lkdGg9MTsKICAgIGZvcihsZXQgZGQ9LW9iLmg7ZGQ8b2IudytvYi5oO2RkKz0xOCl7Yy5iZWdpblBhdGgoKTtjLm1vdmVUbyhvYi54K2RkLG9iLnkpO2MubGluZVRvKG9iLngrZGQrb2IuaCxvYi55K29iLmgpO2Muc3Ryb2tlKCk7fQogICAgYy5yZXN0b3JlKCk7CiAgICBjb25zdCBjczI9OTtjLnN0cm9rZVN0eWxlPXQud2E7Yy5saW5lV2lkdGg9MjsKICAgIFtbb2IueCxvYi55LDEsMV0sW29iLngrb2IudyxvYi55LC0xLDFdLFtvYi54LG9iLnkrb2IuaCwxLC0xXSxbb2IueCtvYi53LG9iLnkrb2IuaCwtMSwtMV1dLmZvckVhY2goKFtieCxieSxzeCxzeV0pPT57Yy5iZWdpblBhdGgoKTtjLm1vdmVUbyhieCtzeCpjczIsYnkpO2MubGluZVRvKGJ4LGJ5KTtjLmxpbmVUbyhieCxieStzeSpjczIpO2Muc3Ryb2tlKCk7fSk7CiAgfQogIGlmKGNob3Nlbk1vZGUuaWQ9PT0na290aCcpZHJhd0tvdGhab25lKCk7Cn0KCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAovLyAgTUFJTiBMT09QCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkApmdW5jdGlvbiBsb29wKHRzKXsKICBpZighcnVubmluZylyZXR1cm47CiAgY29uc3QgZHQ9TWF0aC5taW4oKHRzLWxhc3RUcykvMTAwMCwuMDY1KTtsYXN0VHM9dHM7CiAgZmVlZEl0ZW1zPWZlZWRJdGVtcy5maWx0ZXIoZj0+e2YubGlmZS09ZHQ7cmV0dXJuIGYubGlmZT4wO30pOwogIGlmKHNoYWtlTWFnPi4xMil7c2hha2VYPShNYXRoLnJhbmRvbSgpLS41KSpzaGFrZU1hZyoyO3NoYWtlWT0oTWF0aC5yYW5kb20oKS0uNSkqc2hha2VNYWcqMjtzaGFrZU1hZyo9Ljc4O31lbHNle3NoYWtlWD0wO3NoYWtlWT0wO3NoYWtlTWFnPTA7fQogIC8vIFBvd2VydXAgc3Bhd24KICBwb3d1cFRpbWVyKz1kdDtpZihwb3d1cFRpbWVyPj1wb3d1cEludGVydmFsKXtwb3d1cFRpbWVyPTA7aWYocG93ZXJ1cHMuZmlsdGVyKHA9PiFwLmRlYWQpLmxlbmd0aDw0KXNwYXduUmFuZG9tUG93ZXJ1cCgpO30KICBwb3dlcnVwcz1wb3dlcnVwcy5maWx0ZXIocD0+IXAuZGVhZCk7CiAgZm9yKGNvbnN0IGUgb2YgZW50aXRpZXMpZS51cGRhdGUoZHQpOwogIHJlc29sdmVDb2xsaXNpb25zKCk7CiAgYnVsbGV0cz1idWxsZXRzLmZpbHRlcihiPT57aWYoYi5kZWFkKXJldHVybiBmYWxzZTtiLnVwZGF0ZShkdCk7cmV0dXJuICFiLmRlYWQ7fSk7CiAgcGFydGljbGVzPXBhcnRpY2xlcy5maWx0ZXIocD0+cC5saWZlPjApO2Zvcihjb25zdCBwIG9mIHBhcnRpY2xlcylwLnVwZGF0ZShkdCk7CiAgaWYoY2hvc2VuTW9kZS5pZD09PSdrb3RoJyl1cGRhdGVLT1RIKGR0KTsKICBpZihjaG9zZW5Nb2RlLmlkPT09J2N0Zicpe2Zvcihjb25zdCB0IG9mWydyZWQnLCdibHVlJ10paWYoZmxhZ3NbdF0pZmxhZ3NbdF0udXBkYXRlKGR0KTt9CiAgaWYocGxheWVyJiYhcGxheWVyLmRlYWQpe3VwZFN0YXRzSHVkKCk7dXBkUG93SHVkKCk7fQogIHVwZFNjb3JlSHVkKCk7CiAgcmVuZGVyKCk7CiAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApOwp9CgpmdW5jdGlvbiByZW5kZXIoKXsKICBzY2w9TWF0aC5taW4oY2FudmFzLndpZHRoL0FXLGNhbnZhcy5oZWlnaHQvQUgpOwogIG94PShjYW52YXMud2lkdGgtQVcqc2NsKS8yO295PShjYW52YXMuaGVpZ2h0LUFIKnNjbCkvMjsKICBjdHguY2xlYXJSZWN0KDAsMCxjYW52YXMud2lkdGgsY2FudmFzLmhlaWdodCk7CiAgY3R4LmZpbGxTdHlsZT0nIzAwMCc7Y3R4LmZpbGxSZWN0KDAsMCxjYW52YXMud2lkdGgsY2FudmFzLmhlaWdodCk7CiAgY3R4LnNhdmUoKTtjdHgudHJhbnNsYXRlKG94K3NoYWtlWCxveStzaGFrZVkpO2N0eC5zY2FsZShzY2wsc2NsKTsKICBkcmF3QXJlbmEoKTsKICBmb3IoY29uc3QgcCBvZiBwb3dlcnVwcylpZighcC5kZWFkKXAuZHJhdygpOwogIGlmKGNob3Nlbk1vZGUuaWQ9PT0nY3RmJyl7Zm9yKGNvbnN0IHQgb2ZbJ3JlZCcsJ2JsdWUnXSlpZihmbGFnc1t0XSlmbGFnc1t0XS5kcmF3KCk7fQogIGZvcihjb25zdCBwIG9mIHBhcnRpY2xlcylwLmRyYXcoKTsKICBmb3IoY29uc3QgYiBvZiBidWxsZXRzKWIuZHJhdygpOwogIGZvcihjb25zdCBlIG9mIGVudGl0aWVzKWUuZHJhdygpOwogIGN0eC5yZXN0b3JlKCk7Cn0KCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAovLyAgR0FNRSBJTklUCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkApmdW5jdGlvbiBpbml0R2FtZSgpewogIGN1cnJlbnRNYXA9Z2VuZXJhdGVNYXAoKTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwbmFtZScpLnRleHRDb250ZW50PWN1cnJlbnRNYXAudGhlbWUubmFtZTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaG1vZGUnKS50ZXh0Q29udGVudD1jaG9zZW5Nb2RlLmljb24rJyAnK2Nob3Nlbk1vZGUubmFtZTsKICBlbnRpdGllcz1bXTtidWxsZXRzPVtdO3BhcnRpY2xlcz1bXTtwb3dlcnVwcz1bXTsKICBraWxscz17cmVkOjAsYmx1ZTowfTtrb3RoU2NvcmU9e3JlZDowLGJsdWU6MH07Y3RmQ2Fwcz17cmVkOjAsYmx1ZTowfTtmZmFTY29yZT17fTsKICBmZWVkSXRlbXM9W107CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hmZWVkJykuaW5uZXJIVE1MPScnOwogIGhpZGVSZXNwYXduVUkoKTsKICBwb3d1cFRpbWVyPTA7CiAgLy8gU2hvdyBtb2RlLXNwZWNpZmljIEhVRCBlbGVtZW50cwogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrb3RoLWJhcicpLmNsYXNzTGlzdC50b2dnbGUoJ3Nob3cnLGNob3Nlbk1vZGUuaWQ9PT0na290aCcpOwogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdGYtaHVkJykuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdycsY2hvc2VuTW9kZS5pZD09PSdjdGYnKTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGd1bicpLnN0eWxlLmRpc3BsYXk9Y2hvc2VuTW9kZS5pZD09PSdndW4nPydibG9jayc6J25vbmUnOwoKICBjb25zdCBzcD0odCk9PnQ9PT0ncmVkJz81NStNYXRoLnJhbmRvbSgpKjEzMDpBVy01NS1NYXRoLnJhbmRvbSgpKjEzMDsKICBjb25zdCBpc0ZGQT0hY2hvc2VuTW9kZS50ZWFtczsKICBjb25zdCBlVGVhbT1jaG9zZW5UZWFtPT09J3JlZCc/J2JsdWUnOidyZWQnOwoKICAvLyBQbGF5ZXIKICBjb25zdCBpbml0R3VuPWNob3Nlbk1vZGUuaWQ9PT0nZ3VuJz8ncGlzdG9sJzpjaG9zZW5HdW47CiAgY29uc3QgcDF2MXg9Y2hvc2VuTW9kZS5pZD09PScxdjEnP0FXLzItMjAwOnNwKGNob3NlblRlYW0pOwogIHBsYXllcj1uZXcgRW50aXR5KHAxdjF4LEFILzIrKE1hdGgucmFuZG9tKCktLjUpKjIwMCxjaG9zZW5UZWFtLHBsYXllck5hbWUsdHJ1ZSxjaG9zZW5Ta2luLGluaXRHdW4pOwogIGZmYVNjb3JlW3BsYXllck5hbWVdPTA7CiAgZW50aXRpZXMucHVzaChwbGF5ZXIpOwoKICAvLyBCb3RzICgzIGFsbGllcyArIDQgZW5lbWllcyBmb3IgdGVhbSBtb2RlcywgNyBlbmVtaWVzIGZvciBGRkEpCiAgY29uc3QgbnVtQm90cz1jaG9zZW5Nb2RlLmlkPT09JzF2MSc/MTppc0ZGQT83Ojc7CiAgY29uc3QgYm90U2tpbnM9U0tJTlMubWFwKHM9PnMuaWQpOwoKICBmb3IobGV0IGk9MDtpPG51bUJvdHM7aSsrKXsKICAgIGxldCB0ZWFtLG5hbWU7CiAgICBpZihpc0ZGQSl7CiAgICAgIHRlYW09bnVsbDsKICAgICAgY29uc3QgdD1pPDQ/J3JlZCc6J2JsdWUnO3RlYW09dDsKICAgICAgbmFtZT1CT1RfTkFNRVMuZmZhW2klQk9UX05BTUVTLmZmYS5sZW5ndGhdOwogICAgfSBlbHNlIHsKICAgICAgdGVhbT1pPDM/Y2hvc2VuVGVhbTplVGVhbTsKICAgICAgY29uc3QgcG9vbD1pPDM/Qk9UX05BTUVTW2Nob3NlblRlYW1dOkJPVF9OQU1FU1tlVGVhbV07CiAgICAgIG5hbWU9cG9vbFtpJXBvb2wubGVuZ3RoXTsKICAgIH0KICAgIGNvbnN0IHNrPWJvdFNraW5zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSpib3RTa2lucy5sZW5ndGgpXTsKICAgIGNvbnN0IGduPWNob3Nlbk1vZGUuaWQ9PT0nZ3VuJz8ncGlzdG9sJzpHVU5TW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSpHVU5TLmxlbmd0aCldLmlkOwogICAgY29uc3QgYngxdjE9Y2hvc2VuTW9kZS5pZD09PScxdjEnP0FXLzIrMjAwOnNwKHRlYW0pOwogICAgY29uc3QgZT1uZXcgRW50aXR5KGJ4MXYxLEFILzIrKE1hdGgucmFuZG9tKCktLjUpKjIwMCx0ZWFtLG5hbWUsZmFsc2Usc2ssZ24pOwogICAgZmZhU2NvcmVbbmFtZV09MDsKICAgIGVudGl0aWVzLnB1c2goZSk7CiAgfQoKICAvLyBDVEYgZmxhZ3MKICBpZihjaG9zZW5Nb2RlLmlkPT09J2N0ZicpewogICAgZmxhZ3MucmVkPW5ldyBGbGFnKCdyZWQnKTsKICAgIGZsYWdzLmJsdWU9bmV3IEZsYWcoJ2JsdWUnKTsKICB9CgogIC8vIFNwYXduIGEgZmV3IGluaXRpYWwgcG93ZXJ1cHMKICBmb3IobGV0IGk9MDtpPDM7aSsrKXNwYXduUmFuZG9tUG93ZXJ1cCgpOwogIHVwZFN0YXRzSHVkKCk7dXBkQW1tb0h1ZCgpO3VwZEhwSHVkKCk7dXBkU2NvcmVIdWQoKTsKICBpZihjaG9zZW5Nb2RlLmlkPT09J2d1bicpdXBkR3VuR2FtZUh1ZCgpOwp9CgovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKLy8gIFNDUkVFTlMgLyBNRU5VCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkApmdW5jdGlvbiBzaG93U2NyZWVuKGlkKXtkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2NyZWVuJykuZm9yRWFjaChzPT5zLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTtkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7fQoKZnVuY3Rpb24gc2VsVGVhbSh0ZWFtKXsKICBjaG9zZW5UZWFtPXRlYW07CiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJ0JykuZm9yRWFjaChiPT5iLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbCcpKTsKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnQtJyt0ZWFtKS5jbGFzc0xpc3QuYWRkKCdzZWwnKTsKICBjaGVja1JlYWR5KCk7Cn0KZnVuY3Rpb24gc2VsU2tpbihpZCl7Y2hvc2VuU2tpbj1pZDtkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2snKS5mb3JFYWNoKHM9PnMuY2xhc3NMaXN0LnRvZ2dsZSgnc2VsJyxzLmRhdGFzZXQuaWQ9PT1pZCkpO2NoZWNrUmVhZHkoKTt9CmZ1bmN0aW9uIHNlbEd1bihpZCl7Y2hvc2VuR3VuPWlkO2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5nYycpLmZvckVhY2goZz0+Zy5jbGFzc0xpc3QudG9nZ2xlKCdzZWwnLGcuZGF0YXNldC5pZD09PWlkKSk7Y2hlY2tSZWFkeSgpO30KZnVuY3Rpb24gc2VsTW9kZShpZCl7CiAgY2hvc2VuTW9kZT1NT0RFUy5maW5kKG09Pm0uaWQ9PT1pZCk7CiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1jJykuZm9yRWFjaChtPT5tLmNsYXNzTGlzdC50b2dnbGUoJ3NlbCcsbS5kYXRhc2V0LmlkPT09aWQpKTsKICAvLyBGRkEgJiBHdW4gR2FtZTogaGlkZSB0ZWFtIHBpY2tlciwgYWx3YXlzIHNob3cgZ3VuIHVubGVzcyBndW4gZ2FtZQogIGNvbnN0IG5lZWRUZWFtPWNob3Nlbk1vZGUudGVhbXMmJmNob3Nlbk1vZGUuaWQhPT0nMXYxJzsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVhbS1waWNrJykuc3R5bGUub3BhY2l0eT1uZWVkVGVhbT8nMSc6Jy4zNSc7CiAgaWYoIW5lZWRUZWFtKWNob3NlblRlYW09J3JlZCc7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2d1bi1yb3cnKS5zdHlsZS5kaXNwbGF5PWNob3Nlbk1vZGUuaWQ9PT0nZ3VuJz8nbm9uZSc6J2Jsb2NrJzsKICBpZihjaG9zZW5Nb2RlLmlkPT09J2d1bicpY2hvc2VuR3VuPSdwaXN0b2wnOwogIGNoZWNrUmVhZHkoKTsKfQpmdW5jdGlvbiBjaGVja1JlYWR5KCl7CiAgY29uc3Qgb2s9Y2hvc2VuTW9kZSYmY2hvc2VuU2tpbiYmKGNob3Nlbkd1bnx8Y2hvc2VuTW9kZS5pZD09PSdndW4nKSYmKGNob3NlblRlYW18fCFjaG9zZW5Nb2RlLnRlYW1zKTsKICBjb25zdCBidG49ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JwJyk7CiAgYnRuLnN0eWxlLnZpc2liaWxpdHk9b2s/J3Zpc2libGUnOidoaWRkZW4nOwp9CmZ1bmN0aW9uIHN0YXJ0R2FtZSgpewogIGlmKCFjaG9zZW5Nb2RlKXJldHVybjsKICBwbGF5ZXJOYW1lPShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmknKS52YWx1ZS50cmltKCkudG9VcHBlckNhc2UoKXx8J1BMQVlFUicpLnNsaWNlKDAsMTIpOwogIGlmKCFjaG9zZW5UZWFtKWNob3NlblRlYW09J3JlZCc7CiAgc2hvd1NjcmVlbigncy1nYW1lJyk7CiAgaW5pdEdhbWUoKTsKICBydW5uaW5nPXRydWU7bGFzdFRzPXBlcmZvcm1hbmNlLm5vdygpOwogIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTsKfQpmdW5jdGlvbiBwbGF5QWdhaW4oKXsKICBjaG9zZW5UZWFtPW51bGw7Y2hvc2VuU2tpbj1udWxsO2Nob3Nlbkd1bj1udWxsO2Nob3Nlbk1vZGU9bnVsbDsKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnQsLnNrLC5nYywubWMnKS5mb3JFYWNoKGI9PmIuY2xhc3NMaXN0LnJlbW92ZSgnc2VsJykpOwogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicCcpLnN0eWxlLnZpc2liaWxpdHk9J2hpZGRlbic7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25pJykudmFsdWU9Jyc7CiAgc2hvd1NjcmVlbigncy1tZW51Jyk7Cn0KCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkAovLyAgQlVJTEQgTUVOVQovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKZnVuY3Rpb24gYnVpbGRNZW51KCl7CiAgY29uc3QgbWc9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21nJyk7CiAgTU9ERVMuZm9yRWFjaChtPT57CiAgICBjb25zdCBkPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO2QuY2xhc3NOYW1lPSdtYyc7ZC5kYXRhc2V0LmlkPW0uaWQ7ZC5vbmNsaWNrPSgpPT5zZWxNb2RlKG0uaWQpOwogICAgZC5pbm5lckhUTUw9YDxzcGFuIGNsYXNzPSJtYy1pY29uIj4ke20uaWNvbn08L3NwYW4+PHNwYW4gY2xhc3M9Im1jLW5hbWUiPiR7bS5uYW1lfTwvc3Bhbj48c3BhbiBjbGFzcz0ibWMtZGVzYyI+JHttLmRlc2N9PC9zcGFuPmA7CiAgICBtZy5hcHBlbmRDaGlsZChkKTsKICB9KTsKICBjb25zdCBzZz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2cnKTsKICBTS0lOUy5mb3JFYWNoKHNrPT57CiAgICBjb25zdCBkPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO2QuY2xhc3NOYW1lPSdzayc7ZC5kYXRhc2V0LmlkPXNrLmlkO2Qub25jbGljaz0oKT0+c2VsU2tpbihzay5pZCk7CiAgICBkLmlubmVySFRNTD1gPGRpdiBjbGFzcz0ic3AiIHN0eWxlPSJiYWNrZ3JvdW5kOiR7c2suYm9keUNvbH07Ym94LXNoYWRvdzowIDAgOXB4ICR7c2suZ2xvd0NvbH0iPiR7c2suZW1vaml9PC9kaXY+PGRpdiBjbGFzcz0ic24iPiR7c2submFtZX08L2Rpdj5gOwogICAgc2cuYXBwZW5kQ2hpbGQoZCk7CiAgfSk7CiAgY29uc3QgZ3I9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dyJyk7CiAgR1VOUy5mb3JFYWNoKGc9PnsKICAgIGNvbnN0IGQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7ZC5jbGFzc05hbWU9J2djJztkLmRhdGFzZXQuaWQ9Zy5pZDtkLm9uY2xpY2s9KCk9PnNlbEd1bihnLmlkKTsKICAgIGNvbnN0IHBpcHM9KG4sbWF4PTUsY29sKT0+JzxkaXYgY2xhc3M9InBpcHMiPicrWy4uLkFycmF5KG1heCldLm1hcCgoXyxpKT0+YDxkaXYgY2xhc3M9InBpcCIgc3R5bGU9ImJhY2tncm91bmQ6JHtpPG4/Y29sOid2YXIoLS1iZHIpJ30iPjwvZGl2PmApLmpvaW4oJycpKyc8L2Rpdj4nOwogICAgZC5pbm5lckhUTUw9YDxzcGFuIGNsYXNzPSJnbmFtZSIgc3R5bGU9ImNvbG9yOiR7Zy5jb2x9Ij4ke2cuaWNvbn0gJHtnLm5hbWV9PC9zcGFuPjxkaXYgY2xhc3M9InNyb3ciPjxzcGFuIGNsYXNzPSJzbGIiPkRNRzwvc3Bhbj4ke3BpcHMoZy5kLDUsZy5jb2wpfTwvZGl2PjxkaXYgY2xhc3M9InNyb3ciPjxzcGFuIGNsYXNzPSJzbGIiPlNQRDwvc3Bhbj4ke3BpcHMoZy5mLDUsJyNGRkU2MDAnKX08L2Rpdj48ZGl2IGNsYXNzPSJzcm93Ij48c3BhbiBjbGFzcz0ic2xiIj5BTU88L3NwYW4+JHtwaXBzKGcuYSw1LCcjMDBGNUZGJyl9PC9kaXY+YDsKICAgIGdyLmFwcGVuZENoaWxkKGQpOwogIH0pOwp9CgovLyDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKLy8gIElOUFVUCi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkApkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJyxlPT57CiAga2V5c1tlLmtleS50b0xvd2VyQ2FzZSgpXT10cnVlOwogIGlmKCFwbGF5ZXJ8fHBsYXllci5kZWFkfHwhcnVubmluZylyZXR1cm47CiAgaWYoZS5rZXk9PT0nICcpe2UucHJldmVudERlZmF1bHQoKTtwbGF5ZXIuc2hvb3QocGxheWVyLmFuZ2xlKTt9CiAgaWYoZS5rZXkudG9Mb3dlckNhc2UoKT09PSdmJylwbGF5ZXIuc3RhcnRNZWxlZSgpOwogIGlmKGUua2V5LnRvTG93ZXJDYXNlKCk9PT0ncicpcGxheWVyLnJlbG9hZCgpOwogIGlmKGUua2V5LnRvTG93ZXJDYXNlKCk9PT0nZScmJmNob3Nlbk1vZGUuaWQ9PT0nY3RmJyl7CiAgICAvLyBNYW51YWwgZmxhZyBpbnRlcmFjdCBoYW5kbGVkIGluIHVwZGF0ZSBsb29wCiAgfQp9KTsKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLGU9PntrZXlzW2Uua2V5LnRvTG93ZXJDYXNlKCldPWZhbHNlO30pOwpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLGU9Pnttb3VzZS54PWUuY2xpZW50WDttb3VzZS55PWUuY2xpZW50WTt9KTsKCndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywoKT0+ewogIGNhbnZhcz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2MnKTtjdHg9Y2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgY29uc3QgcmVzaXplPSgpPT57Y2FudmFzLndpZHRoPXdpbmRvdy5pbm5lcldpZHRoO2NhbnZhcy5oZWlnaHQ9d2luZG93LmlubmVySGVpZ2h0O307CiAgcmVzaXplKCk7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScscmVzaXplKTsKICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJyxlPT57CiAgICBtb3VzZWRvd249dHJ1ZTsKICAgIGlmKCFwbGF5ZXJ8fHBsYXllci5kZWFkfHwhcnVubmluZylyZXR1cm47CiAgICBpZihlLmJ1dHRvbj09PTApcGxheWVyLnNob290KHBsYXllci5hbmdsZSk7CiAgICBpZihlLmJ1dHRvbj09PTIpcGxheWVyLnN0YXJ0TWVsZWUoKTsKICB9KTsKICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsKCk9Pm1vdXNlZG93bj1mYWxzZSk7CiAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCgpPT5tb3VzZWRvd249ZmFsc2UpOwogIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsZT0+ZS5wcmV2ZW50RGVmYXVsdCgpKTsKICBidWlsZE1lbnUoKTsKfSk7Cjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4K"

HTML_BYTES = base64.b64decode(HTML_B64)

class GameHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        if self.path in ('/', '/index.html', '/game'):
            self.send_response(200)
            self.send_header('Content-Type', 'text/html; charset=utf-8')
            self.send_header('Content-Length', str(len(HTML_BYTES)))
            self.send_header('Cache-Control', 'no-cache')
            self.end_headers()
            self.wfile.write(HTML_BYTES)
        else:
            self.send_response(404)
            self.end_headers()
            self.wfile.write(b'Not Found')

    def log_message(self, fmt, *args):
        print(f"[REQUEST] {self.address_string()} - {fmt % args}", flush=True)

if __name__ == '__main__':
    port = int(os.environ.get('PORT', 7373))
    host = '0.0.0.0'  # Required for Railway

    env = os.environ.get('RAILWAY_ENVIRONMENT', '')
    print(f"""
             
          
          
        
        
          

  Game Server  |  http://{host}:{port}
  {"Running on Railway" if env else "Running locally  open http://localhost:" + str(port)}
    """, flush=True)

    server = HTTPServer((host, port), GameHandler)
    try:
        server.serve_forever()
    except KeyboardInterrupt:
        print("\n[SERVER] Shutting down...", flush=True)
        server.shutdown()
